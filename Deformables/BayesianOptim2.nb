(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    236898,       5417]
NotebookOptionsPosition[    232955,       5333]
NotebookOutlinePosition[    233378,       5349]
CellTagsIndexPosition[    233335,       5346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization Notebook", "Section",
 CellChangeTimes->{{3.845436265544322*^9, 3.845436267767584*^9}, {
  3.879829219378184*^9, 
  3.8798292217526894`*^9}},ExpressionUUID->"6c742f1b-1d09-41c9-b63b-\
f5db958d3384"],

Cell[CellGroupData[{

Cell["Filament setup function", "Subsection",
 CellChangeTimes->{{3.8798292327618303`*^9, 
  3.8798292459600377`*^9}},ExpressionUUID->"720b4dae-050c-4218-aa7e-\
219c6456de55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Variable", " ", 
      RowBox[{"definitions", ":", "\[IndentingNewLine]", " ", "L"}]}], " ", 
     "=", " ", 
     RowBox[{"filament", " ", "length"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R10", " ", "=", " ", 
     RowBox[{
      RowBox[{"M", "-", 
       RowBox[{
       "dimensional", " ", "array", " ", "of", " ", "inner", " ", "radii", 
        " ", "at", " ", "Z"}]}], " ", "=", " ", "0"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"R20", " ", "=", " ", 
     RowBox[{
      RowBox[{"M", "-", 
       RowBox[{
       "dimensional", " ", "array", " ", "of", " ", "outer", " ", "radii", 
        " ", "at", " ", "Z"}]}], " ", "=", " ", "0"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"filled", " ", "=", " ", 
     RowBox[{"if", " ", "True"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "the", " ", "filament", " ", "is", " ", "considered", " ", 
      "to", " ", "be", " ", "filled", " ", "for", " ", "R"}], " ", "<", " ", 
     RowBox[{
      SubsuperscriptBox["R", "1", "1"], " ", "as", " ", "well"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"EE", " ", "=", " ", 
     RowBox[{"M", "-", 
      RowBox[{"dimensional", " ", "array", " ", "of", " ", 
       RowBox[{"Young", "'"}], "s", " ", "moduli"}]}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"\[Nu]", " ", "=", " ", 
     RowBox[{"M", "-", 
      RowBox[{"dimensional", " ", "array", " ", "of", " ", 
       RowBox[{"Poisson", "'"}], "s", " ", "ratios"}]}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"\[Alpha]2til", " ", "=", " ", 
     RowBox[{"M", "-", 
      RowBox[{
      "dimensional", " ", "array", " ", "of", " ", "helical", " ", "fiber", 
       " ", "angles"}]}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"\[Sigma]", " ", "=", " ", 
     RowBox[{"M", "-", 
      RowBox[{
      "dimensional", " ", "array", " ", "of", " ", "\[Sigma]", " ", 
       "parameters", " ", 
       RowBox[{"(", 
        RowBox[{
        "angular", " ", "extents", " ", "of", " ", "active", " ", "sectors"}],
         ")"}]}]}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"N\[Gamma]", " ", "=", " ", 
     RowBox[{"M", "-", 
      RowBox[{
      "dimensional", " ", "array", " ", "of", " ", "N\[Gamma]", " ", 
       "parameters", " ", 
       RowBox[{"(", 
        RowBox[{"numbers", " ", "of", " ", "active", " ", "sectors"}], 
        ")"}]}]}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"\[Theta]0", " ", "=", " ", 
     RowBox[{"M", "-", 
      RowBox[{
      "dimensional", " ", "array", " ", "of", " ", "\[Theta]0", " ", 
       "offsets"}]}]}], ","}], "\[IndentingNewLine]", " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"filamentSetup", "[", 
    RowBox[{
    "L_", ",", "R10_", ",", "R20_", ",", "filled_", ",", "EE_", ",", "\[Nu]_",
      ",", "\[Alpha]2til_", ",", "\[Sigma]_", ",", "N\[Gamma]_", ",", 
     "\[Theta]0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "R0", ",", "R1", ",", "R2", ",", "r0", ",", "d10", ",", "d20", ",", 
       "\[Phi]2", ",", "nRings", ",", "\[Gamma]Piecewise", ",", 
       "FourierIn\[Gamma]", ",", "a0SymTab", ",", "a1SymTab", ",", "b1SymTab",
        ",", "rPar", ",", "dPar", ",", "\[Gamma]List", ",", "\[Zeta]HatSym", 
       ",", "u1HatSym", ",", "u2HatSym", ",", "u3HatSym"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R0", "=", 
       RowBox[{"Last", "[", "R20", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"R2", "=", "R20"}], ";", "\[IndentingNewLine]", 
      RowBox[{"R1", "=", 
       RowBox[{
        RowBox[{"R10", "/", "R20"}], "*", "R2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r0", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d10", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d20", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]2", "=", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"-", 
         RowBox[{"D", "[", 
          RowBox[{"R2", ",", "Z"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nRings", "=", 
       RowBox[{"Length", "[", "\[Alpha]2til", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]Piecewise", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"\[Gamma]", ",", 
           RowBox[{
            RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
            RowBox[{"ToString", "[", "j", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nRings"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"N\[Gamma]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]List", "=", 
       RowBox[{"Flatten", "[", "\[Gamma]Piecewise", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PiecewiseConstActiv", "[", 
       RowBox[{"\[Gamma]Piecewise", ",", "\[Sigma]", ",", "\[Theta]0"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FourierIn\[Gamma]", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"PiecewiseConstActiv", "[", 
         RowBox[{"\[Gamma]Piecewise", ",", "\[Sigma]", ",", "\[Theta]0"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a0SymTab", ",", "a1SymTab", ",", "b1SymTab"}], "}"}], "=", 
       RowBox[{"InitSymbolicParams", "[", "nRings", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rPar", ",", "dPar"}], "}"}], "=", 
       RowBox[{"ParamCLineDirector\[Gamma]", "[", 
        RowBox[{
        "r0", ",", "d10", ",", "d20", ",", "L", ",", "a0SymTab", ",", 
         "a1SymTab", ",", "b1SymTab", ",", "\[Gamma]List", ",", 
         "FourierIn\[Gamma]", ",", "EE", ",", "R1", ",", "R2", ",", 
         "\[Alpha]2til", ",", "\[Nu]", ",", "filled", ",", "R0", ",", 
         "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", "u3HatSym"}], 
        "}"}], "=", 
       RowBox[{"preComputeU\[Gamma]", "[", 
        RowBox[{
        "a0SymTab", ",", "a1SymTab", ",", "b1SymTab", ",", 
         "FourierIn\[Gamma]", ",", "EE", ",", "R1", ",", "R2", ",", 
         "\[Alpha]2til", ",", "\[Nu]", ",", "filled", ",", "R0"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "rPar", ",", "dPar", ",", "\[Gamma]List", ",", "\[Zeta]HatSym", ",", 
        "u1HatSym", ",", "u2HatSym", ",", "u3HatSym"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.880533417422371*^9, 3.880533426238485*^9}, {
  3.880533746290409*^9, 3.8805340351611996`*^9}, {3.8805344215243855`*^9, 
  3.8805344256254497`*^9}},ExpressionUUID->"c08016c8-4247-4697-95c1-\
9c157bfc9410"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mechanical model (Active Filaments)", "Subsection",
 CellChangeTimes->{{3.8454363340634155`*^9, 3.84543634810544*^9}, {
  3.8454364008378296`*^9, 3.845436436132079*^9}, {3.845437930159171*^9, 
  3.8454379318400755`*^9}, {3.8798292538223925`*^9, 
  3.8798292592819443`*^9}},ExpressionUUID->"57c9140b-0491-41b0-a967-\
887b7dab3aff"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  RowBox[{"Functions", " ", "for", " ", "computing", " ", 
   SubscriptBox["\[Delta]", "i"]}]],
  InitializationCell->True,
  CellChangeTimes->{{3.8454305418403454`*^9, 3.8454305671063137`*^9}, {
    3.845431825193738*^9, 3.845431844918564*^9}, {3.8454318810203476`*^9, 
    3.8454318863166327`*^9}, {3.8454319401010127`*^9, 
    3.8454321168795857`*^9}, {3.845432201957675*^9, 3.8454323745647836`*^9}, {
    3.8454338283262014`*^9, 3.8454338286957593`*^9}, {3.845433864545312*^9, 
    3.8454341153724313`*^9}, {3.845434176640876*^9, 3.8454342254649105`*^9}, {
    3.84543426757371*^9, 3.8454342679437723`*^9}, {3.8454343054828844`*^9, 
    3.845434335419937*^9}, {3.845434400231531*^9, 3.8454348407540307`*^9}, {
    3.8454353880651536`*^9, 3.845435396463391*^9}, {3.8454354361274295`*^9, 
    3.8454355916694503`*^9}, {3.845436036344754*^9, 3.8454360718062162`*^9}, {
    3.845436169805235*^9, 3.845436197229418*^9}, {3.8454379213984413`*^9, 
    3.845437921833023*^9}, {3.845441145697851*^9, 3.8454411494057074`*^9}, {
    3.845441234227051*^9, 3.8454412385614233`*^9}, {3.8454412739834275`*^9, 
    3.8454412767560277`*^9}, {3.8454414644447794`*^9, 
    3.8454415955319786`*^9}, {3.845441724939147*^9, 3.8454417282621107`*^9}, {
    3.845509290334695*^9, 3.8455093151245756`*^9}, {3.845510930714999*^9, 
    3.845510939023294*^9}, {3.8461401873205094`*^9, 3.846140191317532*^9}, {
    3.8461859564331737`*^9, 3.846186062778335*^9}, {3.8461862606834145`*^9, 
    3.8461862844375143`*^9}, {3.8461863261242037`*^9, 
    3.8461863422744465`*^9}, {3.846186449338355*^9, 3.8461864508524675`*^9}, {
    3.8461918685156946`*^9, 3.8461919214677367`*^9}, {3.8461921926954155`*^9, 
    3.846192213216296*^9}, {3.8461930161264877`*^9, 3.8461930277454057`*^9}, {
    3.846194210978252*^9, 3.8461942283797655`*^9}, {3.846207569074148*^9, 
    3.8462075692647996`*^9}, {3.8473155561181297`*^9, 3.847315575064296*^9}, {
    3.847341627691141*^9, 3.84734163824006*^9}, {3.84795164410196*^9, 
    3.8479516685060654`*^9}, {3.847951727933252*^9, 3.8479517338648005`*^9}, {
    3.8479519800089903`*^9, 3.8479519941450024`*^9}, {3.847952102971916*^9, 
    3.8479521249709272`*^9}, 3.8479522432698455`*^9, 3.8479522911948347`*^9, {
    3.8479523267086945`*^9, 3.847952456783258*^9}, {3.847952491201606*^9, 
    3.847952559605711*^9}, {3.847952611121705*^9, 3.847952718617689*^9}, {
    3.8479528007185144`*^9, 3.847952860533331*^9}, 3.8480306309573193`*^9, {
    3.8480307065778985`*^9, 3.8480307131485577`*^9}, {3.848030762064568*^9, 
    3.848030809003553*^9}, 3.848030900095767*^9, {3.84803097644981*^9, 
    3.8480309830661106`*^9}, {3.8480310245617266`*^9, 3.848031030712391*^9}, 
    3.84803111964755*^9, 3.848031150505461*^9, 3.848031217122435*^9, {
    3.848031528514639*^9, 3.84803160259948*^9}, {3.8480316897762804`*^9, 
    3.84803175138034*^9}, {3.848200241598373*^9, 3.848200273245146*^9}, {
    3.848200309036688*^9, 3.8482003392763505`*^9}, {3.8490387513562455`*^9, 
    3.8490387534891386`*^9}, {3.8524057986088495`*^9, 
    3.8524058367488537`*^9}, {3.852405867541931*^9, 3.852405968062168*^9}, {
    3.8526083298392973`*^9, 3.8526083392855463`*^9}, {3.855091006469943*^9, 
    3.855091033603816*^9}, {3.8594007745406303`*^9, 3.8594008405944643`*^9}, {
    3.8594009844802628`*^9, 3.8594010002354765`*^9}, {3.859401570939508*^9, 
    3.859401574076285*^9}, {3.8594833059315944`*^9, 3.8594833130883775`*^9}, {
    3.859491622569105*^9, 3.8594916397232475`*^9}, {3.860003803585251*^9, 
    3.860003819230999*^9}, {3.860003947759924*^9, 3.860003947967641*^9}, {
    3.8600279749674397`*^9, 3.8600279886743035`*^9}, {3.8614635212024317`*^9, 
    3.8614635232175946`*^9}, 3.8614635606196003`*^9, {3.8614636194141407`*^9, 
    3.8614636441083612`*^9}, {3.861675019081479*^9, 3.8616750369985476`*^9}, {
    3.8616751205152063`*^9, 3.861675139646005*^9}, {3.861675203717139*^9, 
    3.8616752205439053`*^9}, {3.8616752605892534`*^9, 3.8616752607673893`*^9},
     3.8632224368824973`*^9, {3.8632226905183115`*^9, 
    3.8632226923400865`*^9}, {3.8632233620865154`*^9, 3.863223364283738*^9}, {
    3.8798291356905947`*^9, 3.879829136543596*^9}, {3.879829171324763*^9, 
    3.8798291915182266`*^9}, {3.880534051628307*^9, 3.8805341291752377`*^9}},
  ExpressionUUID->"1fd5b5ce-0ea2-4adc-b93e-e308f9265cc8"],
 " in all possible cases (tapered vs. non-tapered; limiting cases)"
}], "Subsubsection",
 CellChangeTimes->{{3.8805341569906616`*^9, 
  3.880534168016602*^9}},ExpressionUUID->"dbf447d5-8e5a-4b3b-b59f-\
9f130fbea081"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Non", "-", "tapered"}], ",", " ", 
    RowBox[{"non", "-", "limiting"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"computeDeltas", "[", 
      RowBox[{"R1_", ",", "R2_", ",", "\[Alpha]2_", ",", "\[Nu]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Delta]0", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
           RowBox[{"R2", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "2"}], "*", 
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"R2", "^", "2"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{"Sec", "[", "\[Alpha]2", "]"}], "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"R1", "^", "2"}], "*", 
                 RowBox[{
                  RowBox[{"Tan", "[", "\[Alpha]2", "]"}], "^", "2"}]}], "+", 
                RowBox[{"R2", "^", "2"}]}], ")"}]}]}], "]"}]}], "+", 
          RowBox[{"\[Nu]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"R1", "^", "2"}], "-", 
             RowBox[{"R2", "^", "2"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"R1", "-", "R2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"R1", "^", "2"}], "+", 
                RowBox[{"R2", "*", "R1"}], "+", 
                RowBox[{"R2", "^", "2"}]}], ")"}]}], "-", 
             RowBox[{"3", "*", 
              RowBox[{"(", 
               RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
              RowBox[{"R2", "^", "2"}], "*", 
              RowBox[{
               RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "2"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"3", "*", 
           RowBox[{"(", 
            RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
           RowBox[{"R2", "^", "3"}], "*", 
           RowBox[{
            RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "3"}], "*", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"R1", "*", 
             RowBox[{
              RowBox[{"Tan", "[", "\[Alpha]2", "]"}], "/", "R2"}]}], "]"}]}], 
          "-", 
          RowBox[{"3", "*", "\[Alpha]2", "*", 
           RowBox[{"(", 
            RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
           RowBox[{"R2", "^", "3"}], "*", 
           RowBox[{
            RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "3"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]2", "=", "\[Delta]1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]3", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Nu]"}], ")"}]}], "*", "R2", "*", 
          RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"R1", "^", "2"}], "-", 
            RowBox[{"R2", "^", "2"}], "+", 
            RowBox[{
             RowBox[{"R2", "^", "2"}], "*", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "2"}], "*", 
             RowBox[{"Log", "[", 
              RowBox[{"2", "*", 
               RowBox[{
                RowBox[{"R2", "^", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R2", "^", "2"}], "-", 
                    RowBox[{"R1", "^", "2"}]}], ")"}], "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", "*", "\[Alpha]2"}], "]"}]}], "+", 
                  RowBox[{"R1", "^", "2"}], "+", 
                  RowBox[{"R2", "^", "2"}]}], ")"}]}]}], "]"}]}]}], ")"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Non", "-", "tapered"}], ",", " ", "limiting"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeDeltasWithLimits", "[", 
      RowBox[{"R1_", ",", "R2_", ",", "\[Alpha]2Val_", ",", "\[Nu]Val_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Alpha]2", ",", "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", 
         ",", "\[Delta]3", ",", "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Delta]0", "=", 
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
             RowBox[{"R2", "^", "2"}], "*", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "2"}], "*", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"R2", "^", "2"}], "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sec", "[", "\[Alpha]2", "]"}], "^", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"R1", "^", "2"}], "*", 
                   RowBox[{
                    RowBox[{"Tan", "[", "\[Alpha]2", "]"}], "^", "2"}]}], "+", 
                  RowBox[{"R2", "^", "2"}]}], ")"}]}]}], "]"}]}], "+", 
            RowBox[{"\[Nu]", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"R1", "^", "2"}], "-", 
               RowBox[{"R2", "^", "2"}]}], ")"}]}]}], ",", 
           RowBox[{"\[Alpha]2", "->", "\[Alpha]2Val"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]1", "=", 
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"R1", "-", "R2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"R1", "^", "2"}], "+", 
                  RowBox[{"R2", "*", "R1"}], "+", 
                  RowBox[{"R2", "^", "2"}]}], ")"}]}], "-", 
               RowBox[{"3", "*", 
                RowBox[{"(", 
                 RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
                RowBox[{"R2", "^", "2"}], "*", 
                RowBox[{
                 RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "2"}]}]}], 
              ")"}]}], "+", 
            RowBox[{"3", "*", 
             RowBox[{"(", 
              RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
             RowBox[{"R2", "^", "3"}], "*", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "3"}], "*", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"R1", "*", 
               RowBox[{
                RowBox[{"Tan", "[", "\[Alpha]2", "]"}], "/", "R2"}]}], 
              "]"}]}], "-", 
            RowBox[{"3", "*", "\[Alpha]2", "*", 
             RowBox[{"(", 
              RowBox[{"\[Nu]", "+", "1"}], ")"}], "*", 
             RowBox[{"R2", "^", "3"}], "*", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "3"}]}]}], ",", 
           RowBox[{"\[Alpha]2", "->", "\[Alpha]2Val"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]2", "=", "\[Delta]1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]3", "=", 
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}]}], "*", "R2", "*", 
            RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R1", "^", "2"}], "-", 
              RowBox[{"R2", "^", "2"}], "+", 
              RowBox[{
               RowBox[{"R2", "^", "2"}], "*", 
               RowBox[{
                RowBox[{"Cot", "[", "\[Alpha]2", "]"}], "^", "2"}], "*", 
               RowBox[{"Log", "[", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"R2", "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R2", "^", "2"}], "-", 
                    RowBox[{"R1", "^", "2"}]}], ")"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "*", "\[Alpha]2"}], "]"}]}], "+", 
                    RowBox[{"R1", "^", "2"}], "+", 
                    RowBox[{"R2", "^", "2"}]}], ")"}]}]}], "]"}]}]}], ")"}]}],
            ",", 
           RowBox[{"\[Alpha]2", "->", "\[Alpha]2Val"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}],
           "}"}], "/.", 
         RowBox[{"\[Nu]", "->", "\[Nu]Val"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Tapered", ",", " ", 
     RowBox[{"non", "-", "limiting"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeDeltasTapered", "[", 
      RowBox[{
      "R1_", ",", "R2_", ",", "\[Alpha]2til_", ",", "\[Beta]til_", ",", 
       "\[Phi]2_", ",", "\[Nu]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["c", 
          OverscriptBox["\[Alpha]", "~"]], "=", 
         RowBox[{
          RowBox[{"Tan", "[", "\[Alpha]2til", "]"}], "/", "R2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["c", "\[Phi]"], "=", 
         RowBox[{
          RowBox[{"Tan", "[", "\[Phi]2", "]"}], "/", "R2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]0", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                SubsuperscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], ")"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R1", "2"], " ", 
                  SubsuperscriptBox["c", 
                   OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R2", "2"], " ", 
                  SubsuperscriptBox["c", 
                   OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}]}], "]"}], 
             " ", 
             RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
             SubsuperscriptBox["c", "\[Phi]", "3"], " ", 
             SubscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"]]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R1", "2"], " ", 
                  SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R2", "2"], " ", 
                  SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}]}], "]"}], 
             " ", 
             RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
             SubscriptBox["c", "\[Phi]"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "3"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R1", "2"], " ", 
                  SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R2", "2"], " ", 
                  SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}]}], "]"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], "2"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "4"]}], "-", 
            RowBox[{
             SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                RowBox[{"Log", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}]}], 
                   ")"}]}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"R1", "-", "R2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"R1", "+", "R2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Nu]", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Beta]til"}], "]"}]}]}], ")"}], " ", 
                SubsuperscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}]}], "+", 
            RowBox[{
             SubsuperscriptBox["c", "\[Phi]", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                RowBox[{"Log", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}]}], "]"}], 
                " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Beta]til", "]"}], "2"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"R1", "-", "R2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"R1", "+", "R2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Nu]", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Beta]til"}], "]"}]}]}], ")"}], " ", 
                SubsuperscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"], "2"]}]}], ")"}]}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]1", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["c", "\[Phi]", "3"], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                SubsuperscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], ")"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ArcTan", "[", 
                RowBox[{"R1", " ", 
                 SubscriptBox["c", "\[Phi]"]}], "]"}], "-", 
               RowBox[{"ArcTan", "[", 
                RowBox[{"R2", " ", 
                 SubscriptBox["c", "\[Phi]"]}], "]"}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], "2"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "5"]}], "+", 
            RowBox[{"12", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
             SubsuperscriptBox["c", "\[Phi]", "4"], " ", 
             SubscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ArcTan", "[", 
                RowBox[{"R1", " ", 
                 SubscriptBox["c", 
                  OverscriptBox["\[Alpha]", "~"]]}], "]"}], "-", 
               RowBox[{"ArcTan", "[", 
                RowBox[{"R2", " ", 
                 SubscriptBox["c", 
                  OverscriptBox["\[Alpha]", "~"]]}], "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "R1"}], "+", "R2"}], ")"}], " ", 
                SubscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"]]}]}], ")"}]}], "-", 
            RowBox[{"6", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
             SubscriptBox["c", "\[Phi]"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"R1", " ", 
                    SubscriptBox["c", "\[Phi]"]}], "]"}], "-", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"R2", " ", 
                    SubscriptBox["c", "\[Phi]"]}], "]"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"R1", "-", "R2"}], ")"}], " ", 
                RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
                SubscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"]]}]}], ")"}]}], "+", 
            RowBox[{"6", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ArcTan", "[", 
                RowBox[{"R1", " ", 
                 SubscriptBox["c", "\[Phi]"]}], "]"}], "-", 
               RowBox[{"ArcTan", "[", 
                RowBox[{"R2", " ", 
                 SubscriptBox["c", "\[Phi]"]}], "]"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"R1", "-", "R2"}], ")"}], " ", 
                RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
                SubscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"]]}]}], ")"}]}], "-", 
            RowBox[{
             SubsuperscriptBox["c", "\[Phi]", "3"], " ", 
             SubsuperscriptBox["c", 
              OverscriptBox["\[Alpha]", "~"], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"R1", " ", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}], "]"}], "-", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"R2", " ", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}], "]"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["R1", "3"], "-", 
                  SuperscriptBox["R2", "3"]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Nu]", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Beta]til"}], "]"}]}]}], ")"}], " ", 
                SubsuperscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"], "3"]}]}], ")"}]}], "+", 
            RowBox[{
             SubsuperscriptBox["c", "\[Phi]", "5"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "6"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"R1", " ", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}], "]"}], "-", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"R2", " ", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}], "]"}]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Beta]til", "]"}], "2"]}], "+", 
               RowBox[{"6", " ", 
                RowBox[{"(", 
                 RowBox[{"R1", "-", "R2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Beta]til", "]"}], "2"], " ", 
                SubscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"]]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["R1", "3"], "-", 
                  SuperscriptBox["R2", "3"]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Nu]", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Beta]til"}], "]"}]}]}], ")"}], " ", 
                SubsuperscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"], "3"]}]}], ")"}]}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]2", "=", "\[Delta]1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]3", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["c", "\[Phi]", "3"], " ", 
               SubsuperscriptBox["c", 
                OverscriptBox["\[Alpha]", "~"], "3"], " ", 
               RowBox[{"\[Sqrt]", 
                RowBox[{"(", 
                 RowBox[{
                  SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                  SubsuperscriptBox["c", 
                   OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}]}], ")"}]}],
             ")"}], 
           RowBox[{"Cos", "[", "\[Beta]til", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", "R1", " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}], "+", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], ")"}]}], 
                   ")"}]}], "]"}], "-", 
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", "R2", " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}], "+", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], ")"}]}], 
                   ")"}]}], "]"}], "-", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"ArcTanh", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R1", " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], ")"}]}], 
                    ")"}]}], "]"}]}], "+", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"ArcTanh", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R2", " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SubscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"]]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                    SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], ")"}]}], 
                    ")"}]}], "]"}]}]}], ")"}], " ", 
              SubsuperscriptBox["c", "\[Phi]", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
                 SubscriptBox["c", "\[Phi]"]}], "-", 
                SubscriptBox["c", 
                 OverscriptBox["\[Alpha]", "~"]]}], ")"}]}], "+", 
             RowBox[{"6", " ", 
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
              SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
              SubscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"]], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "-", 
             RowBox[{"6", " ", 
              SubscriptBox["c", "\[Phi]"], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "2"], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "3"], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["R1", "2"], " ", 
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
              SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "3"], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R1", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "-", 
             RowBox[{"6", " ", 
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
              SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
              SubscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"]], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "+", 
             RowBox[{"6", " ", 
              SubscriptBox["c", "\[Phi]"], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "2"], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "3"], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["R2", "2"], " ", 
              RowBox[{"Sin", "[", "\[Beta]til", "]"}], " ", 
              SubsuperscriptBox["c", "\[Phi]", "2"], " ", 
              SubsuperscriptBox["c", 
               OverscriptBox["\[Alpha]", "~"], "3"], " ", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["R2", "2"], " ", 
                    SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["c", "\[Phi]", "2"], "-", 
                   SubsuperscriptBox["c", 
                    OverscriptBox["\[Alpha]", "~"], "2"]}], ")"}]}], 
                ")"}]}]}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Tapered", ",", " ", "limiting"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeDeltasTaperedAxial", "[", 
      RowBox[{"R1_", ",", "R2_", ",", "\[Phi]2_", ",", "\[Nu]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["c", "\[Phi]"], "=", 
         RowBox[{
          RowBox[{"Tan", "[", "\[Phi]2", "]"}], "/", "R2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]0", "=", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"R1", "-", "R2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"R1", "+", "R2"}], ")"}], " ", "\[Nu]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R1", "2"], " ", 
                  SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  SuperscriptBox["R2", "2"], " ", 
                  SubsuperscriptBox["c", "\[Phi]", "2"]}]}], ")"}]}], "]"}]}],
             ")"}], "/", 
           SubsuperscriptBox["c", "\[Phi]", "2"]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]1", "=", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["R1", "3"], "-", 
             SuperscriptBox["R2", "3"]}], ")"}], " ", "\[Nu]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"6", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Nu]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ArcTan", "[", 
                RowBox[{"R1", " ", 
                 SubscriptBox["c", "\[Phi]"]}], "]"}], "-", 
               RowBox[{"ArcTan", "[", 
                RowBox[{"R2", " ", 
                 SubscriptBox["c", "\[Phi]"]}], "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "R1"}], "+", "R2"}], ")"}], " ", 
                SubscriptBox["c", "\[Phi]"]}]}], ")"}]}], ")"}], "/", 
           SubsuperscriptBox["c", "\[Phi]", "3"]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]2", "=", "\[Delta]1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]3", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8454305418403454`*^9, 3.8454305671063137`*^9}, {
   3.845431825193738*^9, 3.845431844918564*^9}, {3.8454318810203476`*^9, 
   3.8454318863166327`*^9}, {3.8454319401010127`*^9, 
   3.8454321168795857`*^9}, {3.845432201957675*^9, 3.8454323745647836`*^9}, {
   3.8454338283262014`*^9, 3.8454338286957593`*^9}, {3.845433864545312*^9, 
   3.8454341153724313`*^9}, {3.845434176640876*^9, 3.8454342254649105`*^9}, {
   3.84543426757371*^9, 3.8454342679437723`*^9}, {3.8454343054828844`*^9, 
   3.845434335419937*^9}, {3.845434400231531*^9, 3.8454348407540307`*^9}, {
   3.8454353880651536`*^9, 3.845435396463391*^9}, {3.8454354361274295`*^9, 
   3.8454355916694503`*^9}, {3.845436036344754*^9, 3.8454360718062162`*^9}, {
   3.845436169805235*^9, 3.845436197229418*^9}, {3.8454379213984413`*^9, 
   3.845437921833023*^9}, {3.845441145697851*^9, 3.8454411494057074`*^9}, {
   3.845441234227051*^9, 3.8454412385614233`*^9}, {3.8454412739834275`*^9, 
   3.8454412767560277`*^9}, {3.8454414644447794`*^9, 
   3.8454415955319786`*^9}, {3.845441724939147*^9, 3.8454417282621107`*^9}, {
   3.845509290334695*^9, 3.8455093151245756`*^9}, {3.845510930714999*^9, 
   3.845510939023294*^9}, {3.8461401873205094`*^9, 3.846140191317532*^9}, {
   3.8461859564331737`*^9, 3.846186062778335*^9}, {3.8461862606834145`*^9, 
   3.8461862844375143`*^9}, {3.8461863261242037`*^9, 
   3.8461863422744465`*^9}, {3.846186449338355*^9, 3.8461864508524675`*^9}, {
   3.8461918685156946`*^9, 3.8461919214677367`*^9}, {3.8461921926954155`*^9, 
   3.846192213216296*^9}, {3.8461930161264877`*^9, 3.8461930277454057`*^9}, {
   3.846194210978252*^9, 3.8461942283797655`*^9}, {3.846207569074148*^9, 
   3.8462075692647996`*^9}, {3.8473155561181297`*^9, 3.847315575064296*^9}, {
   3.847341627691141*^9, 3.84734163824006*^9}, {3.84795164410196*^9, 
   3.8479516685060654`*^9}, {3.847951727933252*^9, 3.8479517338648005`*^9}, {
   3.8479519800089903`*^9, 3.8479519941450024`*^9}, {3.847952102971916*^9, 
   3.8479521249709272`*^9}, 3.8479522432698455`*^9, 3.8479522911948347`*^9, {
   3.8479523267086945`*^9, 3.847952456783258*^9}, {3.847952491201606*^9, 
   3.847952559605711*^9}, {3.847952611121705*^9, 3.847952718617689*^9}, {
   3.8479528007185144`*^9, 3.847952860533331*^9}, 3.8480306309573193`*^9, {
   3.8480307065778985`*^9, 3.8480307131485577`*^9}, {3.848030762064568*^9, 
   3.848030809003553*^9}, 3.848030900095767*^9, {3.84803097644981*^9, 
   3.8480309830661106`*^9}, {3.8480310245617266`*^9, 3.848031030712391*^9}, 
   3.84803111964755*^9, 3.848031150505461*^9, 3.848031217122435*^9, {
   3.848031528514639*^9, 3.84803160259948*^9}, {3.8480316897762804`*^9, 
   3.84803175138034*^9}, {3.848200241598373*^9, 3.848200273245146*^9}, {
   3.848200309036688*^9, 3.8482003392763505`*^9}, {3.8490387513562455`*^9, 
   3.8490387534891386`*^9}, {3.8524057986088495`*^9, 
   3.8524058367488537`*^9}, {3.852405867541931*^9, 3.852405968062168*^9}, {
   3.8526083298392973`*^9, 3.8526083392855463`*^9}, {3.855091006469943*^9, 
   3.855091033603816*^9}, {3.8594007745406303`*^9, 3.8594008405944643`*^9}, {
   3.8594009844802628`*^9, 3.8594010002354765`*^9}, {3.859401570939508*^9, 
   3.859401574076285*^9}, {3.8594833059315944`*^9, 3.8594833130883775`*^9}, {
   3.859491622569105*^9, 3.8594916397232475`*^9}, {3.860003803585251*^9, 
   3.860003819230999*^9}, {3.860003947759924*^9, 3.860003947967641*^9}, {
   3.8600279749674397`*^9, 3.8600279886743035`*^9}, {3.8614635212024317`*^9, 
   3.8614635232175946`*^9}, 3.8614635606196003`*^9, {3.8614636194141407`*^9, 
   3.8614636441083612`*^9}, {3.861675019081479*^9, 3.8616750369985476`*^9}, {
   3.8616751205152063`*^9, 3.861675139646005*^9}, {3.861675203717139*^9, 
   3.8616752205439053`*^9}, {3.8616752605892534`*^9, 3.8616752607673893`*^9}, 
   3.8632224368824973`*^9, {3.8632226905183115`*^9, 3.8632226923400865`*^9}, {
   3.8632233620865154`*^9, 3.863223364283738*^9}, {3.8798291356905947`*^9, 
   3.879829136543596*^9}, {3.879829171324763*^9, 3.8798291915182266`*^9}, {
   3.880534051628307*^9, 3.8805341291752377`*^9}, {3.88053417794014*^9, 
   3.8805341901630526`*^9}, {3.8805342221169395`*^9, 
   3.880534249999954*^9}},ExpressionUUID->"d3e665d9-e463-4803-b6a1-\
50cad8c71a54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Piecewise constant uniform activation", "Subsubsection",
 CellChangeTimes->{{3.84544031998361*^9, 3.845440331266012*^9}, 
   3.8805444083396544`*^9},ExpressionUUID->"9ca6cd07-308c-4d7c-88e2-\
96e1a1508922"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PiecewiseConstActivSingleRing", "[", 
     RowBox[{"\[Gamma]_", ",", "\[Sigma]_", ",", "\[Theta]0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"N", ",", "a0", ",", "a1", ",", "b1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"N", "=", 
        RowBox[{"Length", "[", "\[Gamma]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a0", "=", 
        RowBox[{
         RowBox[{"\[Sigma]", "/", "Pi"}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a1", "=", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Sigma]", "/", "2"}], "]"}], "/", "Pi"}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Gamma]", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]0", "+", 
              RowBox[{"2", "*", "Pi", "*", 
               RowBox[{"i", "/", "N"}]}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b1", "=", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Sigma]", "/", "2"}], "]"}], "/", "Pi"}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Gamma]", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]0", "+", 
              RowBox[{"2", "*", "Pi", "*", 
               RowBox[{"i", "/", "N"}]}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"a0", ",", "a1", ",", "b1"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiecewiseConstActiv", "[", 
    RowBox[{"\[Gamma]_", ",", "\[Sigma]_", ",", "\[Theta]0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nRings", ",", "aAll"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nRings", "=", 
       RowBox[{"Length", "[", "\[Gamma]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"aAll", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PiecewiseConstActivSingleRing", "[", 
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Theta]0", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"aAll", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"aAll", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"aAll", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "3"}], "]"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8454403364115*^9, 3.845440633052993*^9}, {
  3.8454408050233774`*^9, 3.845440812983687*^9}, {3.8454408553978434`*^9, 
  3.8454409053617144`*^9}, {3.8454409565638437`*^9, 3.8454409924962864`*^9}, {
  3.8454418507369356`*^9, 3.845441855445022*^9}, {3.845447237490162*^9, 
  3.8454472468854237`*^9}, {3.8454818574782133`*^9, 3.845481861958976*^9}, {
  3.8454967952293797`*^9, 3.8454967983506002`*^9}, {3.845497138307847*^9, 
  3.8454971582225504`*^9}, {3.8805443962983556`*^9, 
  3.8805443986849904`*^9}},ExpressionUUID->"d9e2df5d-efdb-4802-a1fb-\
1f4703cc9281"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for computing the H and K quantities", "Subsubsection",
 CellChangeTimes->{{3.8805342628454924`*^9, 
  3.8805342775381975`*^9}},ExpressionUUID->"aac5519e-ed5a-4eab-b054-\
cfedecc3bf32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Non", "-", "tapered"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"computeH", "[", 
      RowBox[{
      "a0_", ",", "a1_", ",", "b1_", ",", "EE_", ",", "R1_", ",", "R2_", ",", 
       "\[Alpha]2_", ",", "\[Nu]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "H0", ",", "H1", ",", "H2", ",", "H3", ",", "\[Delta]0", ",", 
         "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3", ",", "A", ",", 
         "\[CurlyPhi]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}],
           "}"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Alpha]2", "!=", "0"}], ",", 
           RowBox[{"computeDeltas", "[", 
            RowBox[{"R1", ",", "R2", ",", "\[Alpha]2", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"computeDeltasWithLimits", "[", 
            RowBox[{"R1", ",", "R2", ",", "\[Alpha]2", ",", "\[Nu]"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a1", "^", "2"}], "+", 
           RowBox[{"b1", "^", "2"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]", "=", 
         RowBox[{"-", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"a1", ",", "b1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H0", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"EE", "*", 
           RowBox[{"Pi", "/", "2"}], "*", "\[Delta]0", "*", "a0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"H1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"-", "EE"}], "*", 
            RowBox[{"Pi", "/", "3"}], "*", "\[Delta]1", "*", "A", "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[CurlyPhi]", "-", 
              RowBox[{
               RowBox[{"Z", "/", "R2"}], "*", 
               RowBox[{"Tan", "[", "\[Alpha]2", "]"}]}]}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H2", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"EE", "*", 
            RowBox[{"Pi", "/", "3"}], "*", "\[Delta]2", "*", "A", "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[CurlyPhi]", "-", 
              RowBox[{
               RowBox[{"Z", "/", "R2"}], "*", 
               RowBox[{"Tan", "[", "\[Alpha]2", "]"}]}]}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H3", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"EE", "*", 
           RowBox[{"Pi", "/", "2"}], "*", "\[Delta]3", "*", 
           RowBox[{"a0", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Nu]"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"H0", ",", "H1", ",", "H2", ",", "H3"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Tapered", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeHTapered", "[", 
      RowBox[{
      "a0_", ",", "a1_", ",", "b1_", ",", "EE_", ",", "R1_", ",", "R2_", ",", 
       "\[Alpha]2til_", ",", "\[Beta]til_", ",", "\[Phi]2_", ",", "\[Nu]_", 
       ",", "i_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "H0", ",", "H1", ",", "H2", ",", "H3", ",", "\[Delta]0", ",", 
         "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3", ",", "A", ",", 
         "\[CurlyPhi]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Delta]0", ",", "\[Delta]1", ",", "\[Delta]2", ",", "\[Delta]3"}],
           "}"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"PossibleZeroQ", "[", "\[Alpha]2til", "]"}], ",", 
           RowBox[{"computeDeltasTaperedAxial", "[", 
            RowBox[{"R1", ",", "R2", ",", "\[Phi]2", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"computeDeltasTapered", "[", 
            RowBox[{
            "R1", ",", "R2", ",", "\[Alpha]2til", ",", "\[Beta]til", ",", 
             "\[Phi]2", ",", "\[Nu]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PossibleZeroQ", "[", 
           RowBox[{"D", "[", 
            RowBox[{"R2", ",", 
             RowBox[{"{", 
              RowBox[{"Z", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalTheta]2", "[", "i", "]"}], "[", "ZZ_", "]"}], 
           "=", 
           RowBox[{
            RowBox[{"Tan", "[", "\[Alpha]2til", "]"}], "*", 
            RowBox[{"Integrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"R2", ",", 
                    RowBox[{"Z", "->", "s"}]}], "]"}], ",", "s"}], "]"}], 
                    ")"}], "^", "2"}]}], "]"}], "/", "R2"}], "/.", 
               RowBox[{"Z", "->", "s"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "0", ",", "ZZ"}], "}"}], ",", 
              RowBox[{"Assumptions", "->", 
               RowBox[{"{", 
                RowBox[{"0", "<=", "ZZ", "<=", "L"}], "}"}]}]}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalTheta]2", "[", "i", "]"}], "[", 
            RowBox[{"ZZ_", "?", "NumericQ"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"Tan", "[", "\[Alpha]2til", "]"}], "*", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"R2", ",", 
                    RowBox[{"Z", "->", "s"}]}], "]"}], ",", "s"}], "]"}], 
                    ")"}], "^", "2"}]}], "]"}], "/", "R2"}], "/.", 
               RowBox[{"Z", "->", "s"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "0", ",", "ZZ"}], "}"}]}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"D\[CapitalTheta]2", "[", "i", "]"}], "[", "Z_", "]"}], ":=", 
         RowBox[{
          RowBox[{"Tan", "[", "\[Alpha]2til", "]"}], "*", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"D", "[", 
                RowBox[{"R2", ",", "Z"}], "]"}], ")"}], "^", "2"}]}], "]"}], 
           "/", "R2"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a1", "^", "2"}], "+", 
           RowBox[{"b1", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]", "=", 
         RowBox[{"-", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"a1", ",", "b1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H0", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"EE", "*", 
           RowBox[{"Pi", "/", "4"}], "*", "\[Delta]0", "*", "a0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"H1", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"-", "EE"}], "*", 
           RowBox[{"Pi", "/", "6"}], "*", "\[Delta]1", "*", "A", "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[CurlyPhi]", "-", 
             RowBox[{
              RowBox[{"\[CapitalTheta]2", "[", "i", "]"}], "[", "Z", "]"}]}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H2", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"EE", "*", 
           RowBox[{"Pi", "/", "6"}], "*", "\[Delta]2", "*", "A", "*", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[CurlyPhi]", "-", 
             RowBox[{
              RowBox[{"\[CapitalTheta]2", "[", "i", "]"}], "[", "Z", "]"}]}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H3", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"EE", "*", 
           RowBox[{"Pi", "/", "6"}], "*", "\[Delta]3", "*", "a0"}], "]"}]}], 
        ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"No", " ", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Nu]"}], ")"}]}], " ", "since", " ", "this", 
           " ", "is", " ", "not", " ", "the", " ", "same", " ", "\[Delta]3", 
           " ", "as", " ", "in", " ", "the", " ", "non"}], "-", 
          RowBox[{"tapered", " ", "case"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"H0", ",", "H1", ",", "H2", ",", "H3"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "stiffnesses", " ", "K", " ", "are", " ", "the", " ", "same",
       " ", "in", " ", "tapered", " ", "and", " ", "non"}], "-", 
     RowBox[{"tapered", " ", "cases"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeK", "[", 
      RowBox[{
      "EE_", ",", "R1_", ",", "R2_", ",", "\[Nu]_", ",", "filled_", ",", 
       "R0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"K0", ",", "K1", ",", "K2", ",", "K3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K0", "=", 
         RowBox[{"If", "[", 
          RowBox[{"filled", ",", 
           RowBox[{"EE", "*", "Pi", "*", 
            RowBox[{"R0", "^", "2"}]}], ",", 
           RowBox[{"EE", "*", "Pi", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R2", "^", "2"}], "-", 
              RowBox[{"R1", "^", "2"}]}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"K1", "=", 
         RowBox[{"If", "[", 
          RowBox[{"filled", ",", 
           RowBox[{"EE", "*", 
            RowBox[{"Pi", "/", "4"}], "*", 
            RowBox[{"R0", "^", "4"}]}], ",", 
           RowBox[{"EE", "*", 
            RowBox[{"Pi", "/", "4"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R2", "^", "4"}], "-", 
              RowBox[{"R1", "^", "4"}]}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"K2", "=", "K1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"K3", "=", 
         RowBox[{"If", "[", 
          RowBox[{"filled", ",", 
           RowBox[{"EE", "*", 
            RowBox[{"Pi", "/", 
             RowBox[{"(", 
              RowBox[{"4", "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "\[Nu]"}], ")"}]}], ")"}]}], "*", 
            RowBox[{"R0", "^", "4"}]}], ",", 
           RowBox[{"EE", "*", 
            RowBox[{"Pi", "/", 
             RowBox[{"(", 
              RowBox[{"4", "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "\[Nu]"}], ")"}]}], ")"}]}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"R2", "^", "4"}], "-", 
              RowBox[{"R1", "^", "4"}]}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"K0", ",", "K1", ",", "K2", ",", "K3"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8454305418403454`*^9, 3.8454305671063137`*^9}, {
   3.845431825193738*^9, 3.845431844918564*^9}, {3.8454318810203476`*^9, 
   3.8454318863166327`*^9}, {3.8454319401010127`*^9, 
   3.8454321168795857`*^9}, {3.845432201957675*^9, 3.8454323745647836`*^9}, {
   3.8454338283262014`*^9, 3.8454338286957593`*^9}, {3.845433864545312*^9, 
   3.8454341153724313`*^9}, {3.845434176640876*^9, 3.8454342254649105`*^9}, {
   3.84543426757371*^9, 3.8454342679437723`*^9}, {3.8454343054828844`*^9, 
   3.845434335419937*^9}, {3.845434400231531*^9, 3.8454348407540307`*^9}, {
   3.8454353880651536`*^9, 3.845435396463391*^9}, {3.8454354361274295`*^9, 
   3.8454355916694503`*^9}, {3.845436036344754*^9, 3.8454360718062162`*^9}, {
   3.845436169805235*^9, 3.845436197229418*^9}, {3.8454379213984413`*^9, 
   3.845437921833023*^9}, {3.845441145697851*^9, 3.8454411494057074`*^9}, {
   3.845441234227051*^9, 3.8454412385614233`*^9}, {3.8454412739834275`*^9, 
   3.8454412767560277`*^9}, {3.8454414644447794`*^9, 
   3.8454415955319786`*^9}, {3.845441724939147*^9, 3.8454417282621107`*^9}, {
   3.845509290334695*^9, 3.8455093151245756`*^9}, {3.845510930714999*^9, 
   3.845510939023294*^9}, {3.8461401873205094`*^9, 3.846140191317532*^9}, {
   3.8461859564331737`*^9, 3.846186062778335*^9}, {3.8461862606834145`*^9, 
   3.8461862844375143`*^9}, {3.8461863261242037`*^9, 
   3.8461863422744465`*^9}, {3.846186449338355*^9, 3.8461864508524675`*^9}, {
   3.8461918685156946`*^9, 3.8461919214677367`*^9}, {3.8461921926954155`*^9, 
   3.846192213216296*^9}, {3.8461930161264877`*^9, 3.8461930277454057`*^9}, {
   3.846194210978252*^9, 3.8461942283797655`*^9}, {3.846207569074148*^9, 
   3.8462075692647996`*^9}, {3.8473155561181297`*^9, 3.847315575064296*^9}, {
   3.847341627691141*^9, 3.84734163824006*^9}, {3.84795164410196*^9, 
   3.8479516685060654`*^9}, {3.847951727933252*^9, 3.8479517338648005`*^9}, {
   3.8479519800089903`*^9, 3.8479519941450024`*^9}, {3.847952102971916*^9, 
   3.8479521249709272`*^9}, 3.8479522432698455`*^9, 3.8479522911948347`*^9, {
   3.8479523267086945`*^9, 3.847952456783258*^9}, {3.847952491201606*^9, 
   3.847952559605711*^9}, {3.847952611121705*^9, 3.847952718617689*^9}, {
   3.8479528007185144`*^9, 3.847952860533331*^9}, 3.8480306309573193`*^9, {
   3.8480307065778985`*^9, 3.8480307131485577`*^9}, {3.848030762064568*^9, 
   3.848030809003553*^9}, 3.848030900095767*^9, {3.84803097644981*^9, 
   3.8480309830661106`*^9}, {3.8480310245617266`*^9, 3.848031030712391*^9}, 
   3.84803111964755*^9, 3.848031150505461*^9, 3.848031217122435*^9, {
   3.848031528514639*^9, 3.84803160259948*^9}, {3.8480316897762804`*^9, 
   3.84803175138034*^9}, {3.848200241598373*^9, 3.848200273245146*^9}, {
   3.848200309036688*^9, 3.8482003392763505`*^9}, {3.8490387513562455`*^9, 
   3.8490387534891386`*^9}, {3.8524057986088495`*^9, 
   3.8524058367488537`*^9}, {3.852405867541931*^9, 3.852405968062168*^9}, {
   3.8526083298392973`*^9, 3.8526083392855463`*^9}, {3.855091006469943*^9, 
   3.855091033603816*^9}, {3.8594007745406303`*^9, 3.8594008405944643`*^9}, {
   3.8594009844802628`*^9, 3.8594010002354765`*^9}, {3.859401570939508*^9, 
   3.859401574076285*^9}, {3.8594833059315944`*^9, 3.8594833130883775`*^9}, {
   3.859491622569105*^9, 3.8594916397232475`*^9}, {3.860003803585251*^9, 
   3.860003819230999*^9}, {3.860003947759924*^9, 3.860003947967641*^9}, {
   3.8600279749674397`*^9, 3.8600279886743035`*^9}, {3.8614635212024317`*^9, 
   3.8614635232175946`*^9}, 3.8614635606196003`*^9, {3.8614636194141407`*^9, 
   3.8614636441083612`*^9}, {3.861675019081479*^9, 3.8616750369985476`*^9}, {
   3.8616751205152063`*^9, 3.861675139646005*^9}, {3.861675203717139*^9, 
   3.8616752205439053`*^9}, {3.8616752605892534`*^9, 3.8616752607673893`*^9}, 
   3.8632224368824973`*^9, {3.8632226905183115`*^9, 3.8632226923400865`*^9}, {
   3.8632233620865154`*^9, 3.863223364283738*^9}, {3.8798291356905947`*^9, 
   3.879829136543596*^9}, {3.879829171324763*^9, 3.8798291915182266`*^9}, {
   3.880534051628307*^9, 3.8805341291752377`*^9}, {3.88053417794014*^9, 
   3.8805341901630526`*^9}, {3.8805342221169395`*^9, 3.880534249999954*^9}, {
   3.8805342806925063`*^9, 
   3.8805343840363054`*^9}},ExpressionUUID->"c26a56aa-81a0-460d-85ed-\
f49eb3767a59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Functions for computing the intrinsic curvatures ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["u", "^"], "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4d328f4e-e7c8-4926-af66-246e3195101e"],
 " and the extension ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Zeta]", "^"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b0799db2-95ea-4dd8-8556-7dc6a36285f6"]
}], "Subsubsection",
 CellChangeTimes->{{3.88053438987243*^9, 3.8805343990815897`*^9}, {
  3.88053443338472*^9, 
  3.8805344935231524`*^9}},ExpressionUUID->"6c51bf03-0137-4d80-af21-\
9a7006d83ac9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Non", "-", "tapered"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"computeU", "[", 
      RowBox[{
      "a0_", ",", "a1_", ",", "b1_", ",", "EE_", ",", "R1_", ",", "R2_", ",", 
       "\[Alpha]2_", ",", "\[Nu]_", ",", "filled_", ",", "R0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Zeta]", ",", "u1", ",", "u2", ",", "u3", ",", "nRings", ",", 
         "HTab", ",", "KTab", ",", "H0", ",", "H1", ",", "H2", ",", "H3", ",",
          "K0", ",", "K1", ",", "K2", ",", "K3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nRings", "=", 
         RowBox[{"Length", "[", "a0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"H0", ",", "H1", ",", "H2", ",", "H3"}], "}"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"computeH", "[", 
            RowBox[{
             RowBox[{"a0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"a1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"b1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"EE", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Alpha]2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Nu]", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"K0", ",", "K1", ",", "K2", ",", "K3"}], "}"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"computeK", "[", 
            RowBox[{
             RowBox[{"EE", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Nu]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "filled", ",", "R0"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Zeta]", "=", 
         RowBox[{"1", "+", 
          RowBox[{"H0", "/", "K0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u1", "=", 
         RowBox[{"H1", "/", "K1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u2", "=", 
         RowBox[{
          RowBox[{"-", "H2"}], "/", "K2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u3", "=", 
         RowBox[{"H3", "/", "K3"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Zeta]", ",", "u1", ",", "u2", ",", "u3"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Tapered", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeUTapered", "[", 
      RowBox[{
      "a0_", ",", "a1_", ",", "b1_", ",", "EE_", ",", "R1_", ",", "R2_", ",", 
       "\[Alpha]2til_", ",", "\[Beta]til_", ",", "\[Phi]2_", ",", "\[Nu]_", 
       ",", "filled_", ",", "R0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Zeta]", ",", "u1", ",", "u2", ",", "u3", ",", "nRings", ",", 
         "HTab", ",", "KTab", ",", "H0", ",", "H1", ",", "H2", ",", "H3", ",",
          "K0", ",", "K1", ",", "K2", ",", "K3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nRings", "=", 
         RowBox[{"Length", "[", "a0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{"\[CapitalTheta]2", ",", "D\[CapitalTheta]2"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"H0", ",", "H1", ",", "H2", ",", "H3"}], "}"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"computeHTapered", "[", 
            RowBox[{
             RowBox[{"a0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"a1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"b1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"EE", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Alpha]2til", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Beta]til", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Phi]2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Nu]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"K0", ",", "K1", ",", "K2", ",", "K3"}], "}"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"computeK", "[", 
            RowBox[{
             RowBox[{"EE", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"R2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"\[Nu]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "filled", ",", "R0"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Zeta]", "=", 
         RowBox[{"1", "+", 
          RowBox[{"H0", "/", "K0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u1", "=", 
         RowBox[{"H1", "/", "K1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u2", "=", 
         RowBox[{
          RowBox[{"-", "H2"}], "/", "K2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u3", "=", 
         RowBox[{"H3", "/", "K3"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Zeta]", ",", "u1", ",", "u2", ",", "u3"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Curvature", " ", "\[Kappa]", " ", "and", " ", "torsion", " ", "\[Tau]"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"curvature", "[", 
      RowBox[{"\[Zeta]_", ",", "u1_", ",", "u2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", "\[Zeta]"}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"u1", "^", "2"}], "+", 
        RowBox[{"u2", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"torsion", "[", 
      RowBox[{"\[Zeta]_", ",", "u1_", ",", "u2_", ",", "u3_", ",", "Z_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", "\[Zeta]"}], "*", 
      RowBox[{"(", 
       RowBox[{"u3", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"u2", ",", "Z"}], "]"}], "*", "u1"}], "-", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"u1", ",", "Z"}], "]"}], "*", "u2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u1", "^", "2"}], "+", 
           RowBox[{"u2", "^", "2"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Auxiliary", " ", "precompute", " ", "functions", " ", "to", " ", 
     "improve", " ", "computational", " ", "performance"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"preComputeU\[Gamma]", "[", 
      RowBox[{
      "a0SymTab_", ",", "a1SymTab_", ",", "b1SymTab_", ",", 
       "FourierIn\[Gamma]_", ",", "EE_", ",", "R1_", ",", "R2_", ",", 
       "\[Alpha]2_", ",", "\[Nu]_", ",", "filled_", ",", "R0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", "u3HatSym", 
         ",", "\[Gamma]subRule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", 
           "u3HatSym"}], "}"}], "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"computeU", "[", 
           RowBox[{
           "a0SymTab", ",", "a1SymTab", ",", "b1SymTab", ",", "EE", ",", "R1",
             ",", "R2", ",", "\[Alpha]2", ",", "\[Nu]", ",", "filled", ",", 
            "R0"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]subRule", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"a0SymTab", ",", "a1SymTab", ",", "b1SymTab"}], "}"}], 
              "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "->", 
            RowBox[{"FourierIn\[Gamma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "FourierIn\[Gamma]", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Zeta]HatSym", "=", 
         RowBox[{"\[Zeta]HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u1HatSym", "=", 
         RowBox[{"u1HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u2HatSym", "=", 
         RowBox[{"u2HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u3HatSym", "=", 
         RowBox[{"u3HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", "u3HatSym"}],
          "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"preComputeU\[Gamma]Tapered", "[", 
      RowBox[{
      "a0SymTab_", ",", "a1SymTab_", ",", "b1SymTab_", ",", 
       "FourierIn\[Gamma]_", ",", "EE_", ",", "R1_", ",", "R2_", ",", 
       "\[Alpha]2_", ",", "\[Beta]til_", ",", "\[Phi]2_", ",", "\[Nu]_", ",", 
       "filled_", ",", "R0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", "u3HatSym", 
         ",", "\[Gamma]subRule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", 
           "u3HatSym"}], "}"}], "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"computeUTapered", "[", 
           RowBox[{
           "a0SymTab", ",", "a1SymTab", ",", "b1SymTab", ",", "EE", ",", "R1",
             ",", "R2", ",", "\[Alpha]2", ",", "\[Beta]til", ",", "\[Phi]2", 
            ",", "\[Nu]", ",", "filled", ",", "R0"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]subRule", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"a0SymTab", ",", "a1SymTab", ",", "b1SymTab"}], "}"}], 
              "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "->", 
            RowBox[{"FourierIn\[Gamma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "FourierIn\[Gamma]", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Zeta]HatSym", "=", 
         RowBox[{"\[Zeta]HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u1HatSym", "=", 
         RowBox[{"u1HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u2HatSym", "=", 
         RowBox[{"u2HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u3HatSym", "=", 
         RowBox[{"u3HatSym", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\[Zeta]HatSym", ",", "u1HatSym", ",", "u2HatSym", ",", "u3HatSym"}],
          "}"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8454305418403454`*^9, 3.8454305671063137`*^9}, {
   3.845431825193738*^9, 3.845431844918564*^9}, {3.8454318810203476`*^9, 
   3.8454318863166327`*^9}, {3.8454319401010127`*^9, 
   3.8454321168795857`*^9}, {3.845432201957675*^9, 3.8454323745647836`*^9}, {
   3.8454338283262014`*^9, 3.8454338286957593`*^9}, {3.845433864545312*^9, 
   3.8454341153724313`*^9}, {3.845434176640876*^9, 3.8454342254649105`*^9}, {
   3.84543426757371*^9, 3.8454342679437723`*^9}, {3.8454343054828844`*^9, 
   3.845434335419937*^9}, {3.845434400231531*^9, 3.8454348407540307`*^9}, {
   3.8454353880651536`*^9, 3.845435396463391*^9}, {3.8454354361274295`*^9, 
   3.8454355916694503`*^9}, {3.845436036344754*^9, 3.8454360718062162`*^9}, {
   3.845436169805235*^9, 3.845436197229418*^9}, {3.8454379213984413`*^9, 
   3.845437921833023*^9}, {3.845441145697851*^9, 3.8454411494057074`*^9}, {
   3.845441234227051*^9, 3.8454412385614233`*^9}, {3.8454412739834275`*^9, 
   3.8454412767560277`*^9}, {3.8454414644447794`*^9, 
   3.8454415955319786`*^9}, {3.845441724939147*^9, 3.8454417282621107`*^9}, {
   3.845509290334695*^9, 3.8455093151245756`*^9}, {3.845510930714999*^9, 
   3.845510939023294*^9}, {3.8461401873205094`*^9, 3.846140191317532*^9}, {
   3.8461859564331737`*^9, 3.846186062778335*^9}, {3.8461862606834145`*^9, 
   3.8461862844375143`*^9}, {3.8461863261242037`*^9, 
   3.8461863422744465`*^9}, {3.846186449338355*^9, 3.8461864508524675`*^9}, {
   3.8461918685156946`*^9, 3.8461919214677367`*^9}, {3.8461921926954155`*^9, 
   3.846192213216296*^9}, {3.8461930161264877`*^9, 3.8461930277454057`*^9}, {
   3.846194210978252*^9, 3.8461942283797655`*^9}, {3.846207569074148*^9, 
   3.8462075692647996`*^9}, {3.8473155561181297`*^9, 3.847315575064296*^9}, {
   3.847341627691141*^9, 3.84734163824006*^9}, {3.84795164410196*^9, 
   3.8479516685060654`*^9}, {3.847951727933252*^9, 3.8479517338648005`*^9}, {
   3.8479519800089903`*^9, 3.8479519941450024`*^9}, {3.847952102971916*^9, 
   3.8479521249709272`*^9}, 3.8479522432698455`*^9, 3.8479522911948347`*^9, {
   3.8479523267086945`*^9, 3.847952456783258*^9}, {3.847952491201606*^9, 
   3.847952559605711*^9}, {3.847952611121705*^9, 3.847952718617689*^9}, {
   3.8479528007185144`*^9, 3.847952860533331*^9}, 3.8480306309573193`*^9, {
   3.8480307065778985`*^9, 3.8480307131485577`*^9}, {3.848030762064568*^9, 
   3.848030809003553*^9}, 3.848030900095767*^9, {3.84803097644981*^9, 
   3.8480309830661106`*^9}, {3.8480310245617266`*^9, 3.848031030712391*^9}, 
   3.84803111964755*^9, 3.848031150505461*^9, 3.848031217122435*^9, {
   3.848031528514639*^9, 3.84803160259948*^9}, {3.8480316897762804`*^9, 
   3.84803175138034*^9}, {3.848200241598373*^9, 3.848200273245146*^9}, {
   3.848200309036688*^9, 3.8482003392763505`*^9}, {3.8490387513562455`*^9, 
   3.8490387534891386`*^9}, {3.8524057986088495`*^9, 
   3.8524058367488537`*^9}, {3.852405867541931*^9, 3.852405968062168*^9}, {
   3.8526083298392973`*^9, 3.8526083392855463`*^9}, {3.855091006469943*^9, 
   3.855091033603816*^9}, {3.8594007745406303`*^9, 3.8594008405944643`*^9}, {
   3.8594009844802628`*^9, 3.8594010002354765`*^9}, {3.859401570939508*^9, 
   3.859401574076285*^9}, {3.8594833059315944`*^9, 3.8594833130883775`*^9}, {
   3.859491622569105*^9, 3.8594916397232475`*^9}, {3.860003803585251*^9, 
   3.860003819230999*^9}, {3.860003947759924*^9, 3.860003947967641*^9}, {
   3.8600279749674397`*^9, 3.8600279886743035`*^9}, {3.8614635212024317`*^9, 
   3.8614635232175946`*^9}, 3.8614635606196003`*^9, {3.8614636194141407`*^9, 
   3.8614636441083612`*^9}, {3.861675019081479*^9, 3.8616750369985476`*^9}, {
   3.8616751205152063`*^9, 3.861675139646005*^9}, {3.861675203717139*^9, 
   3.8616752205439053`*^9}, {3.8616752605892534`*^9, 3.8616752607673893`*^9}, 
   3.8632224368824973`*^9, {3.8632226905183115`*^9, 3.8632226923400865`*^9}, {
   3.8632233620865154`*^9, 3.863223364283738*^9}, {3.8798291356905947`*^9, 
   3.879829136543596*^9}, {3.879829171324763*^9, 3.8798291915182266`*^9}, {
   3.880534051628307*^9, 3.8805341291752377`*^9}, {3.88053417794014*^9, 
   3.8805341901630526`*^9}, {3.8805342221169395`*^9, 3.880534249999954*^9}, {
   3.8805342806925063`*^9, 3.8805343840363054`*^9}, {3.880534496786415*^9, 
   3.880534542010439*^9}},ExpressionUUID->"16350554-e7a8-4137-8ac1-\
445756d6bc54"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filament kinematics", "Subsection",
 CellChangeTimes->{{3.845436825543045*^9, 3.8454368273063965`*^9}, {
  3.845437908390457*^9, 3.8454379105346785`*^9}, {3.848720926239296*^9, 
  3.8487209268478813`*^9}, {3.880534562154353*^9, 
  3.880534564423689*^9}},ExpressionUUID->"3d80c9da-94d4-4019-a81f-\
23049b37aad5"],

Cell[CellGroupData[{

Cell["\<\
Initialization functions for the {a0, a1, b1} Fourier coefficients for all M \
rings\
\>", "Subsubsection",
 CellChangeTimes->{
  3.880541605194891*^9},ExpressionUUID->"b8e5d85b-531c-40ca-952c-\
6266533f2f0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Output", " ", "of", " ", "the", " ", "form", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a0", "1"], ",", "...", ",", 
        SubscriptBox["a0", "M"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a1", "1"], ",", "...", ",", 
        SubscriptBox["a1", "M"]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["b1", "1"], ",", "...", ",", 
        SubscriptBox["b1", "M"]}], "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"InitSymbolicParams", "[", "nRings_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"a0", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"a1", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"b1", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Output", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["a0", "1"], ",", 
         SubscriptBox["a1", "1"], ",", 
         SubscriptBox["b1", "1"]}], "}"}], ",", "...", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["a0", "M"], ",", 
         SubscriptBox["a1", "M"], ",", 
         SubscriptBox["b1", "M"]}], "}"}]}], "}"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InitSymbolicParams2", "[", "nRings_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"a0", ",", "i"}], "]"}], ",", 
         RowBox[{"Subscript", "[", 
          RowBox[{"a1", ",", "i"}], "]"}], ",", 
         RowBox[{"Subscript", "[", 
          RowBox[{"b1", ",", "i"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nRings"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845436862300378*^9, 3.845436883856553*^9}, {
   3.845436923950206*^9, 3.845436937541294*^9}, {3.8454369719626455`*^9, 
   3.845437170089178*^9}, {3.8454377738741293`*^9, 3.845437774841053*^9}, {
   3.8454381020641155`*^9, 3.8454381607505307`*^9}, {3.84543819741969*^9, 
   3.84543831242605*^9}, {3.8454401269820995`*^9, 3.845440129220786*^9}, {
   3.845440180046327*^9, 3.845440208967277*^9}, {3.8454410639350543`*^9, 
   3.845441067732806*^9}, {3.8454412147918057`*^9, 3.845441225627466*^9}, {
   3.845441660534977*^9, 3.845441694699603*^9}, {3.8454417608890085`*^9, 
   3.845441761045843*^9}, {3.845442958536887*^9, 3.8454429590930853`*^9}, {
   3.845495789201769*^9, 3.8454958013970203`*^9}, {3.8454964510028305`*^9, 
   3.845496451496945*^9}, {3.845496614790529*^9, 3.8454966460094194`*^9}, {
   3.8461922460169725`*^9, 3.8461922508181906`*^9}, {3.847315542599149*^9, 
   3.8473155459030313`*^9}, {3.8473421605298243`*^9, 
   3.8473421724746323`*^9}, {3.847342695457222*^9, 3.8473427168508396`*^9}, {
   3.848033950926819*^9, 3.848033974559375*^9}, {3.8480340759639263`*^9, 
   3.848034080431595*^9}, {3.8484597843928075`*^9, 3.848459800238886*^9}, {
   3.8487209341185346`*^9, 3.848720934327299*^9}, {3.8524052480724354`*^9, 
   3.852405278050305*^9}, {3.8524057872307253`*^9, 3.8524057939388204`*^9}, {
   3.852405972534984*^9, 3.8524059734278264`*^9}, {3.8524061785405116`*^9, 
   3.85240617887866*^9}, {3.8524361617084026`*^9, 3.8524361778719044`*^9}, {
   3.8524365612441206`*^9, 3.8524365623240485`*^9}, {3.852436849364273*^9, 
   3.8524369524335794`*^9}, {3.8524371460655155`*^9, 3.85243723664649*^9}, {
   3.852437477322982*^9, 3.85243747762814*^9}, 3.852437516448862*^9, {
   3.8525244227433887`*^9, 3.852524427540104*^9}, {3.8525285298627977`*^9, 
   3.8525285983014936`*^9}, {3.8526082201441493`*^9, 
   3.8526083111193285`*^9}, {3.852608540320668*^9, 3.8526085450639153`*^9}, {
   3.8526085824542894`*^9, 3.8526085941487503`*^9}, 3.852608714815042*^9, {
   3.852608919791907*^9, 3.852608930672024*^9}, {3.8526092605229187`*^9, 
   3.8526092606933002`*^9}, {3.859487529198085*^9, 3.8594875526760187`*^9}, {
   3.8600076936779704`*^9, 3.8600076972665825`*^9}, {3.8600077662212224`*^9, 
   3.86000791428586*^9}, {3.8600080820410814`*^9, 3.8600080835627856`*^9}, 
   3.863802547814118*^9, {3.863802677541829*^9, 3.863802704360037*^9}, {
   3.8638030515777454`*^9, 3.863803225075869*^9}, {3.8638032953790407`*^9, 
   3.863803308981656*^9}, {3.8638362874924*^9, 3.863836329038988*^9}, {
   3.864400429842599*^9, 3.864400459118063*^9}, {3.86440053081921*^9, 
   3.8644006854209585`*^9}, {3.864400715867207*^9, 3.864400721494815*^9}, {
   3.8644024683601274`*^9, 3.8644025339881277`*^9}, {3.8644026470490947`*^9, 
   3.8644026474985094`*^9}, {3.864403238617076*^9, 3.8644032744598465`*^9}, {
   3.8644051936089387`*^9, 3.864405205754562*^9}, {3.8763605640638266`*^9, 
   3.8763606167413445`*^9}, {3.876360687326229*^9, 3.876360692347401*^9}, {
   3.8805415409673986`*^9, 
   3.880541716478692*^9}},ExpressionUUID->"6af3755f-5af8-4c3c-aa07-\
6b9306c9a7ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Configuration", " ", 
    RowBox[{"{", 
     RowBox[{"r", ",", " ", 
      RowBox[{"{", 
       RowBox[{"d1", ",", " ", "d2", ",", " ", "d3"}], "}"}]}], "}"}], " ", 
    "parametrized", " ", "in", " ", "\[Gamma]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ParamCLineDirector\[Gamma]", "[", 
      RowBox[{
      "r0_", ",", "d10_", ",", "d20_", ",", "L_", ",", "a0_", ",", "a1_", ",",
        "b1_", ",", "\[Gamma]List_", ",", "FourierIn\[Gamma]_", ",", "EE_", 
       ",", "R1_", ",", "R2_", ",", "\[Alpha]2_", ",", "\[Nu]_", ",", 
       "filled_", ",", "R0_", ",", "inextensible_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "d30", ",", "\[Zeta]", ",", "u1", ",", "u2", ",", "u3", ",", 
         "paramSol", ",", "r1", ",", "r2", ",", "r3", ",", "d11", ",", "d12", 
         ",", "d13", ",", "d21", ",", "d22", ",", "d23", ",", "d31", ",", 
         "d32", ",", "d33", ",", "rPar", ",", "d1Par", ",", "d2Par", ",", 
         "d3Par", ",", "\[Gamma]subRule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d30", "=", 
         RowBox[{"d10", "\[Cross]", "d20"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Zeta]", ",", "u1", ",", "u2", ",", "u3"}], "}"}], "=", 
         RowBox[{"computeU", "[", 
          RowBox[{
          "a0", ",", "a1", ",", "b1", ",", "EE", ",", "R1", ",", "R2", ",", 
           "\[Alpha]2", ",", "\[Nu]", ",", "filled", ",", "R0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]subRule", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"a0", ",", "a1", ",", "b1"}], "}"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "->", 
            RowBox[{"FourierIn\[Gamma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "FourierIn\[Gamma]", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Zeta]", "=", 
         RowBox[{"If", "[", 
          RowBox[{"inextensible", ",", "1", ",", 
           RowBox[{"\[Zeta]", "/.", "\[Gamma]subRule"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\[Zeta]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"u1", "=", 
         RowBox[{"u1", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u2", "=", 
         RowBox[{"u2", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u3", "=", 
         RowBox[{"u3", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"paramSol", "=", 
         RowBox[{"ParametricNDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"d11", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u3", " ", 
                  RowBox[{"d21", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u2", " ", 
                  RowBox[{"d31", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d12", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u3", " ", 
                  RowBox[{"d22", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u2", " ", 
                  RowBox[{"d32", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d13", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u3", " ", 
                  RowBox[{"d23", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u2", " ", 
                  RowBox[{"d33", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d21", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "u3"}], " ", 
                  RowBox[{"d11", "[", "Z", "]"}]}], "+", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d31", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d22", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "u3"}], " ", 
                  RowBox[{"d12", "[", "Z", "]"}]}], "+", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d32", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d23", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "u3"}], " ", 
                  RowBox[{"d13", "[", "Z", "]"}]}], "+", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d33", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d31", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u2", " ", 
                  RowBox[{"d11", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d21", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d32", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u2", " ", 
                  RowBox[{"d12", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d22", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d33", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u2", " ", 
                  RowBox[{"d13", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d23", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"r1", "'"}], "[", "Z", "]"}], "\[Equal]", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"d31", "[", "Z", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"r2", "'"}], "[", "Z", "]"}], "\[Equal]", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"d32", "[", "Z", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"r3", "'"}], "[", "Z", "]"}], "\[Equal]", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"d33", "[", "Z", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"r1", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"r0", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"r2", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"r0", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"r3", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"r0", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d11", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d10", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d12", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d10", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d13", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d10", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d21", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d20", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d22", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d20", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d23", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d20", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d31", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d30", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d32", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d30", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d33", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d30", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "r1", ",", "r2", ",", "r3", ",", "d11", ",", "d12", ",", "d13", 
             ",", "d21", ",", "d22", ",", "d23", ",", "d31", ",", "d32", ",", 
             "d33"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Z", ",", "0", ",", "L"}], "}"}], ",", "\[Gamma]List"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rPar", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "}"}], "/.", "paramSol"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"d1Par", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d11", ",", "d12", ",", "d13"}], "}"}], "/.", 
          "paramSol"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d2Par", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d21", ",", "d22", ",", "d23"}], "}"}], "/.", 
          "paramSol"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d3Par", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d31", ",", "d32", ",", "d33"}], "}"}], "/.", 
          "paramSol"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rPar", ",", 
          RowBox[{"{", 
           RowBox[{"d1Par", ",", "d2Par", ",", "d3Par"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"For", " ", "the", " ", "tapered", " ", "case"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ParamCLineDirectorTapered\[Gamma]", "[", 
      RowBox[{
      "r0_", ",", "d10_", ",", "d20_", ",", "L_", ",", "a0_", ",", "a1_", ",",
        "b1_", ",", "\[Gamma]List_", ",", "FourierIn\[Gamma]_", ",", "EE_", 
       ",", "R1_", ",", "R2_", ",", "\[Alpha]2til_", ",", "\[Beta]til_", ",", 
       "\[Phi]2_", ",", "\[Nu]_", ",", "filled_", ",", "R0_", ",", 
       "inextensible_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "d30", ",", "\[Zeta]", ",", "u1", ",", "u2", ",", "u3", ",", 
         "paramSol", ",", "r1", ",", "r2", ",", "r3", ",", "d11", ",", "d12", 
         ",", "d13", ",", "d21", ",", "d22", ",", "d23", ",", "d31", ",", 
         "d32", ",", "d33", ",", "rPar", ",", "d1Par", ",", "d2Par", ",", 
         "d3Par", ",", "\[Gamma]subRule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d30", "=", 
         RowBox[{"d10", "\[Cross]", "d20"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Zeta]", ",", "u1", ",", "u2", ",", "u3"}], "}"}], "=", 
         RowBox[{"computeUTapered", "[", 
          RowBox[{
          "a0", ",", "a1", ",", "b1", ",", "EE", ",", "R1", ",", "R2", ",", 
           "\[Alpha]2til", ",", "\[Beta]til", ",", "\[Phi]2", ",", "\[Nu]", 
           ",", "filled", ",", "R0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]subRule", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"a0", ",", "a1", ",", "b1"}], "}"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "->", 
            RowBox[{"FourierIn\[Gamma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "FourierIn\[Gamma]", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Zeta]", "=", 
         RowBox[{"If", "[", 
          RowBox[{"inextensible", ",", "1", ",", 
           RowBox[{"\[Zeta]", "/.", "\[Gamma]subRule"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u1", "=", 
         RowBox[{"u1", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u2", "=", 
         RowBox[{"u2", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u3", "=", 
         RowBox[{"u3", "/.", "\[Gamma]subRule"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"paramSol", "=", 
         RowBox[{"ParametricNDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"d11", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u3", " ", 
                  RowBox[{"d21", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u2", " ", 
                  RowBox[{"d31", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d12", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u3", " ", 
                  RowBox[{"d22", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u2", " ", 
                  RowBox[{"d32", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d13", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u3", " ", 
                  RowBox[{"d23", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u2", " ", 
                  RowBox[{"d33", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d21", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "u3"}], " ", 
                  RowBox[{"d11", "[", "Z", "]"}]}], "+", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d31", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d22", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "u3"}], " ", 
                  RowBox[{"d12", "[", "Z", "]"}]}], "+", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d32", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d23", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "u3"}], " ", 
                  RowBox[{"d13", "[", "Z", "]"}]}], "+", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d33", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d31", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u2", " ", 
                  RowBox[{"d11", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d21", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d32", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u2", " ", 
                  RowBox[{"d12", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d22", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"d33", "'"}], "[", "Z", "]"}], "==", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u2", " ", 
                  RowBox[{"d13", "[", "Z", "]"}]}], "-", 
                 RowBox[{"u1", " ", 
                  RowBox[{"d23", "[", "Z", "]"}]}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"r1", "'"}], "[", "Z", "]"}], "\[Equal]", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"d31", "[", "Z", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"r2", "'"}], "[", "Z", "]"}], "\[Equal]", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"d32", "[", "Z", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"r3", "'"}], "[", "Z", "]"}], "\[Equal]", 
              RowBox[{"\[Zeta]", "*", 
               RowBox[{"d33", "[", "Z", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"r1", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"r0", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"r2", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"r0", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"r3", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"r0", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d11", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d10", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d12", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d10", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d13", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d10", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d21", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d20", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d22", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d20", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d23", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d20", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d31", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d30", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d32", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d30", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"d33", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"d30", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "r1", ",", "r2", ",", "r3", ",", "d11", ",", "d12", ",", "d13", 
             ",", "d21", ",", "d22", ",", "d23", ",", "d31", ",", "d32", ",", 
             "d33"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Z", ",", "0", ",", "L"}], "}"}], ",", "\[Gamma]List"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rPar", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "}"}], "/.", "paramSol"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"d1Par", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d11", ",", "d12", ",", "d13"}], "}"}], "/.", 
          "paramSol"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d2Par", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d21", ",", "d22", ",", "d23"}], "}"}], "/.", 
          "paramSol"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d3Par", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d31", ",", "d32", ",", "d33"}], "}"}], "/.", 
          "paramSol"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rPar", ",", 
          RowBox[{"{", 
           RowBox[{"d1Par", ",", "d2Par", ",", "d3Par"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845436862300378*^9, 3.845436883856553*^9}, {
   3.845436923950206*^9, 3.845436937541294*^9}, {3.8454369719626455`*^9, 
   3.845437170089178*^9}, {3.8454377738741293`*^9, 3.845437774841053*^9}, {
   3.8454381020641155`*^9, 3.8454381607505307`*^9}, {3.84543819741969*^9, 
   3.84543831242605*^9}, {3.8454401269820995`*^9, 3.845440129220786*^9}, {
   3.845440180046327*^9, 3.845440208967277*^9}, {3.8454410639350543`*^9, 
   3.845441067732806*^9}, {3.8454412147918057`*^9, 3.845441225627466*^9}, {
   3.845441660534977*^9, 3.845441694699603*^9}, {3.8454417608890085`*^9, 
   3.845441761045843*^9}, {3.845442958536887*^9, 3.8454429590930853`*^9}, {
   3.845495789201769*^9, 3.8454958013970203`*^9}, {3.8454964510028305`*^9, 
   3.845496451496945*^9}, {3.845496614790529*^9, 3.8454966460094194`*^9}, {
   3.8461922460169725`*^9, 3.8461922508181906`*^9}, {3.847315542599149*^9, 
   3.8473155459030313`*^9}, {3.8473421605298243`*^9, 
   3.8473421724746323`*^9}, {3.847342695457222*^9, 3.8473427168508396`*^9}, {
   3.848033950926819*^9, 3.848033974559375*^9}, {3.8480340759639263`*^9, 
   3.848034080431595*^9}, {3.8484597843928075`*^9, 3.848459800238886*^9}, {
   3.8487209341185346`*^9, 3.848720934327299*^9}, {3.8524052480724354`*^9, 
   3.852405278050305*^9}, {3.8524057872307253`*^9, 3.8524057939388204`*^9}, {
   3.852405972534984*^9, 3.8524059734278264`*^9}, {3.8524061785405116`*^9, 
   3.85240617887866*^9}, {3.8524361617084026`*^9, 3.8524361778719044`*^9}, {
   3.8524365612441206`*^9, 3.8524365623240485`*^9}, {3.852436849364273*^9, 
   3.8524369524335794`*^9}, {3.8524371460655155`*^9, 3.85243723664649*^9}, {
   3.852437477322982*^9, 3.85243747762814*^9}, 3.852437516448862*^9, {
   3.8525244227433887`*^9, 3.852524427540104*^9}, {3.8525285298627977`*^9, 
   3.8525285983014936`*^9}, {3.8526082201441493`*^9, 
   3.8526083111193285`*^9}, {3.852608540320668*^9, 3.8526085450639153`*^9}, {
   3.8526085824542894`*^9, 3.8526085941487503`*^9}, 3.852608714815042*^9, {
   3.852608919791907*^9, 3.852608930672024*^9}, {3.8526092605229187`*^9, 
   3.8526092606933002`*^9}, {3.859487529198085*^9, 3.8594875526760187`*^9}, {
   3.8600076936779704`*^9, 3.8600076972665825`*^9}, {3.8600077662212224`*^9, 
   3.86000791428586*^9}, {3.8600080820410814`*^9, 3.8600080835627856`*^9}, 
   3.863802547814118*^9, {3.863802677541829*^9, 3.863802704360037*^9}, {
   3.8638030515777454`*^9, 3.863803225075869*^9}, {3.8638032953790407`*^9, 
   3.863803308981656*^9}, {3.8638362874924*^9, 3.863836329038988*^9}, {
   3.864400429842599*^9, 3.864400459118063*^9}, {3.86440053081921*^9, 
   3.8644006854209585`*^9}, {3.864400715867207*^9, 3.864400721494815*^9}, {
   3.8644024683601274`*^9, 3.8644025339881277`*^9}, {3.8644026470490947`*^9, 
   3.8644026474985094`*^9}, {3.864403238617076*^9, 3.8644032744598465`*^9}, {
   3.8644051936089387`*^9, 3.864405205754562*^9}, {3.8763605640638266`*^9, 
   3.8763606167413445`*^9}, {3.876360687326229*^9, 3.876360692347401*^9}, {
   3.8805415409673986`*^9, 3.8805416114861417`*^9}, {3.8805417305546103`*^9, 
   3.880541801006923*^9}, {3.8805418509914827`*^9, 3.880541861494326*^9}, {
   3.8805419157719693`*^9, 3.880541939866316*^9}, {3.880543323538886*^9, 
   3.880543326355798*^9}, {3.8819600863768454`*^9, 
   3.881960086921965*^9}},ExpressionUUID->"fca1f60b-726a-4726-95df-\
130cb74a33e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functions that extract the centerline and the director basis functions from \
the parametric solution for a given activation\
\>", "Subsubsection",
 CellChangeTimes->{{3.880543680779882*^9, 
  3.880543717758314*^9}},ExpressionUUID->"1b278c7e-82a8-41c2-842e-\
00ee18113a91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"centerlineVal", "[", 
    RowBox[{"rPar_", ",", "P_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rPar", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"P", "/.", 
        RowBox[{"List", "\[Rule]", "Sequence"}]}], "]"}], "[", "Z", "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directorVal", "[", 
    RowBox[{"dPar_", ",", "P_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dPar", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"P", "/.", 
          RowBox[{"List", "\[Rule]", "Sequence"}]}], "]"}], "[", "Z", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dPar", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"P", "/.", 
          RowBox[{"List", "\[Rule]", "Sequence"}]}], "]"}], "[", "Z", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dPar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"P", "/.", 
          RowBox[{"List", "\[Rule]", "Sequence"}]}], "]"}], "[", "Z", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845436862300378*^9, 3.845436883856553*^9}, {
   3.845436923950206*^9, 3.845436937541294*^9}, {3.8454369719626455`*^9, 
   3.845437170089178*^9}, {3.8454377738741293`*^9, 3.845437774841053*^9}, {
   3.8454381020641155`*^9, 3.8454381607505307`*^9}, {3.84543819741969*^9, 
   3.84543831242605*^9}, {3.8454401269820995`*^9, 3.845440129220786*^9}, {
   3.845440180046327*^9, 3.845440208967277*^9}, {3.8454410639350543`*^9, 
   3.845441067732806*^9}, {3.8454412147918057`*^9, 3.845441225627466*^9}, {
   3.845441660534977*^9, 3.845441694699603*^9}, {3.8454417608890085`*^9, 
   3.845441761045843*^9}, {3.845442958536887*^9, 3.8454429590930853`*^9}, {
   3.845495789201769*^9, 3.8454958013970203`*^9}, {3.8454964510028305`*^9, 
   3.845496451496945*^9}, {3.845496614790529*^9, 3.8454966460094194`*^9}, {
   3.8461922460169725`*^9, 3.8461922508181906`*^9}, {3.847315542599149*^9, 
   3.8473155459030313`*^9}, {3.8473421605298243`*^9, 
   3.8473421724746323`*^9}, {3.847342695457222*^9, 3.8473427168508396`*^9}, {
   3.848033950926819*^9, 3.848033974559375*^9}, {3.8480340759639263`*^9, 
   3.848034080431595*^9}, {3.8484597843928075`*^9, 3.848459800238886*^9}, {
   3.8487209341185346`*^9, 3.848720934327299*^9}, {3.8524052480724354`*^9, 
   3.852405278050305*^9}, {3.8524057872307253`*^9, 3.8524057939388204`*^9}, {
   3.852405972534984*^9, 3.8524059734278264`*^9}, {3.8524061785405116`*^9, 
   3.85240617887866*^9}, {3.8524361617084026`*^9, 3.8524361778719044`*^9}, {
   3.8524365612441206`*^9, 3.8524365623240485`*^9}, {3.852436849364273*^9, 
   3.8524369524335794`*^9}, {3.8524371460655155`*^9, 3.85243723664649*^9}, {
   3.852437477322982*^9, 3.85243747762814*^9}, 3.852437516448862*^9, {
   3.8525244227433887`*^9, 3.852524427540104*^9}, {3.8525285298627977`*^9, 
   3.8525285983014936`*^9}, {3.8526082201441493`*^9, 
   3.8526083111193285`*^9}, {3.852608540320668*^9, 3.8526085450639153`*^9}, {
   3.8526085824542894`*^9, 3.8526085941487503`*^9}, 3.852608714815042*^9, {
   3.852608919791907*^9, 3.852608930672024*^9}, {3.8526092605229187`*^9, 
   3.8526092606933002`*^9}, {3.859487529198085*^9, 3.8594875526760187`*^9}, {
   3.8600076936779704`*^9, 3.8600076972665825`*^9}, {3.8600077662212224`*^9, 
   3.86000791428586*^9}, {3.8600080820410814`*^9, 3.8600080835627856`*^9}, 
   3.863802547814118*^9, {3.863802677541829*^9, 3.863802704360037*^9}, {
   3.8638030515777454`*^9, 3.863803225075869*^9}, {3.8638032953790407`*^9, 
   3.863803308981656*^9}, {3.8638362874924*^9, 3.863836329038988*^9}, {
   3.864400429842599*^9, 3.864400459118063*^9}, {3.86440053081921*^9, 
   3.8644006854209585`*^9}, {3.864400715867207*^9, 3.864400721494815*^9}, {
   3.8644024683601274`*^9, 3.8644025339881277`*^9}, {3.8644026470490947`*^9, 
   3.8644026474985094`*^9}, {3.864403238617076*^9, 3.8644032744598465`*^9}, {
   3.8644051936089387`*^9, 3.864405205754562*^9}, {3.8763605640638266`*^9, 
   3.8763606167413445`*^9}, {3.876360687326229*^9, 3.876360692347401*^9}, {
   3.8805415409673986`*^9, 3.8805416114861417`*^9}, {3.8805417305546103`*^9, 
   3.880541801006923*^9}, {3.8805418509914827`*^9, 3.880541861494326*^9}, {
   3.8805419157719693`*^9, 3.880541939866316*^9}, {3.880543323538886*^9, 
   3.880543326355798*^9}},ExpressionUUID->"bb1eafa5-150e-4a44-9010-\
fbd55223d612"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization and control", "Subsection",
 CellChangeTimes->{{3.8524041759815593`*^9, 
  3.852404186080817*^9}},ExpressionUUID->"a92e096d-730e-478e-b9ac-\
4019bb2e5305"],

Cell[CellGroupData[{

Cell["Cost function minimization routines", "Subsubsection",
 CellChangeTimes->{{3.8525229874892073`*^9, 
  3.8525230052442913`*^9}},ExpressionUUID->"bddf7fe9-25f1-48c6-bf8f-\
fc5b2e7f1c60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"JTargetPoint", "[", 
    RowBox[{"rPar_", ",", "P_", ",", "rTarget_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"centerlineVal", "[", 
        RowBox[{"rPar", ",", "P", ",", "Z"}], "]"}], "]"}], "-", "rTarget"}], 
     "]"}], "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JTargetConfiguration", "[", 
     RowBox[{
     "rPar_", ",", "P_", ",", "ZList_", ",", "curvePoints_", ",", 
      "pointWeights_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pointWeights", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"centerlineVal", "[", 
           RowBox[{"rPar", ",", "P", ",", 
            RowBox[{"ZList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", 
          RowBox[{"curvePoints", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "^", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ZList", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimizeFilament", "[", 
     RowBox[{
     "objective_", ",", "rPar_", ",", "P_", ",", "target_", ",", "Z_", ",", 
      "constr_", ",", "NIter_", ",", "method_", ",", "ZList_", ",", 
      "curvePoints_", ",", "pointWeights_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Pmin", ",", "min", ",", "pts"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"min", ",", "pts"}], "}"}], "=", 
        RowBox[{"Reap", "[", 
         RowBox[{"NMinimize", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"objective", "==", "\"\<TargetEndpoint\>\""}], ",", 
                RowBox[{"JTargetPoint", "[", 
                 RowBox[{"rPar", ",", "P", ",", "target", ",", "Z"}], "]"}], 
                ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"objective", "==", "\"\<TargetConfiguration\>\""}], 
                  ",", 
                  RowBox[{"JTargetConfiguration", "[", 
                   RowBox[{
                   "rPar", ",", "P", ",", "ZList", ",", "curvePoints", ",", 
                    "pointWeights"}], "]"}], ",", "0"}], "]"}]}], "]"}], ",", 
              "constr"}], "}"}], "]"}], ",", "P", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "NIter"}], ",", 
           RowBox[{"Method", "->", "method"}], ",", 
           RowBox[{"EvaluationMonitor", ":>", 
            RowBox[{"Sow", "[", "P", "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pmin", "=", 
        RowBox[{"P", "/.", 
         RowBox[{"min", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "min", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Pmin", ",", 
         RowBox[{"min", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"min", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "pts"}], "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimizeFilamentNoPrint", "[", 
     RowBox[{
     "objective_", ",", "rPar_", ",", "P_", ",", "target_", ",", "Z_", ",", 
      "constr_", ",", "NIter_", ",", "method_", ",", "ZList_", ",", 
      "curvePoints_", ",", "pointWeights_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Pmin", ",", "min", ",", "pts"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"min", ",", "pts"}], "}"}], "=", 
        RowBox[{"Reap", "[", 
         RowBox[{"NMinimize", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"objective", "==", "\"\<TargetEndpoint\>\""}], ",", 
                RowBox[{"JTargetPoint", "[", 
                 RowBox[{"rPar", ",", "P", ",", "target", ",", "Z"}], "]"}], 
                ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"objective", "==", "\"\<TargetConfiguration\>\""}], 
                  ",", 
                  RowBox[{"JTargetConfiguration", "[", 
                   RowBox[{
                   "rPar", ",", "P", ",", "ZList", ",", "curvePoints", ",", 
                    "pointWeights"}], "]"}], ",", "0"}], "]"}]}], "]"}], ",", 
              "constr"}], "}"}], "]"}], ",", "P", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "NIter"}], ",", 
           RowBox[{"Method", "->", "method"}], ",", 
           RowBox[{"EvaluationMonitor", ":>", 
            RowBox[{"Sow", "[", 
             RowBox[{"{", 
              RowBox[{"P", ",", 
               RowBox[{"JTargetPoint", "[", 
                RowBox[{"rPar", ",", "P", ",", "target", ",", "Z"}], "]"}]}], 
              "}"}], "]"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pmin", "=", 
        RowBox[{"P", "/.", 
         RowBox[{"min", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Pmin", ",", 
         RowBox[{"min", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"min", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "pts"}], "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimizeFilamentNoPrintRandom", "[", 
     RowBox[{
     "objective_", ",", "rPar_", ",", "P_", ",", "target_", ",", "Z_", ",", 
      "constr_", ",", "NIter_", ",", "method_", ",", "randomSeed_", ",", 
      "ZList_", ",", "curvePoints_", ",", "pointWeights_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Pmin", ",", "min", ",", "pts"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"min", ",", "pts"}], "}"}], "=", 
        RowBox[{"Reap", "[", 
         RowBox[{"NMinimize", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"objective", "==", "\"\<TargetEndpoint\>\""}], ",", 
                RowBox[{"JTargetPoint", "[", 
                 RowBox[{"rPar", ",", "P", ",", "target", ",", "Z"}], "]"}], 
                ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"objective", "==", "\"\<TargetConfiguration\>\""}], 
                  ",", 
                  RowBox[{"JTargetConfiguration", "[", 
                   RowBox[{
                   "rPar", ",", "P", ",", "ZList", ",", "curvePoints", ",", 
                    "pointWeights"}], "]"}], ",", "0"}], "]"}]}], "]"}], ",", 
              "constr"}], "}"}], "]"}], ",", "P", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "NIter"}], ",", 
           RowBox[{"Method", "->", 
            RowBox[{"{", 
             RowBox[{"method", ",", 
              RowBox[{"\"\<RandomSeed\>\"", "->", "randomSeed"}]}], "}"}]}], 
           ",", 
           RowBox[{"EvaluationMonitor", ":>", 
            RowBox[{"Sow", "[", "P", "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pmin", "=", 
        RowBox[{"P", "/.", 
         RowBox[{"min", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Pmin", ",", 
         RowBox[{"min", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"min", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "pts"}], "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimizeFilamentNoPrintRandomInitPoints", "[", 
    RowBox[{
    "initPoints_", ",", "objective_", ",", "rPar_", ",", "P_", ",", "target_",
      ",", "Z_", ",", "constr_", ",", "NIter_", ",", "method_", ",", 
     "randomSeed_", ",", "ZList_", ",", "curvePoints_", ",", 
     "pointWeights_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Pmin", ",", "min", ",", "pts"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"min", ",", "pts"}], "}"}], "=", 
       RowBox[{"Reap", "[", 
        RowBox[{"NMinimize", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"objective", "==", "\"\<TargetEndpoint\>\""}], ",", 
               RowBox[{"JTargetPoint", "[", 
                RowBox[{"rPar", ",", "P", ",", "target", ",", "Z"}], "]"}], 
               ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"objective", "==", "\"\<TargetConfiguration\>\""}], 
                 ",", 
                 RowBox[{"JTargetConfiguration", "[", 
                  RowBox[{
                  "rPar", ",", "P", ",", "ZList", ",", "curvePoints", ",", 
                   "pointWeights"}], "]"}], ",", "0"}], "]"}]}], "]"}], ",", 
             "constr"}], "}"}], "]"}], ",", "P", ",", 
          RowBox[{"MaxIterations", "\[Rule]", "NIter"}], ",", 
          RowBox[{"Method", "->", 
           RowBox[{"{", 
            RowBox[{"method", ",", 
             RowBox[{"\"\<RandomSeed\>\"", "->", "randomSeed"}], ",", 
             RowBox[{"\"\<InitialPoints\>\"", "->", "initPoints"}], ",", 
             RowBox[{"\"\<ShrinkRatio\>\"", "->", "0.85"}], ",", 
             RowBox[{"\"\<ContractRatio\>\"", "->", "0.85"}], ",", 
             RowBox[{"\"\<ReflectRatio\>\"", "->", "2"}]}], "}"}]}], ",", 
          RowBox[{"EvaluationMonitor", ":>", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{"P", ",", 
              RowBox[{"JTargetPoint", "[", 
               RowBox[{"rPar", ",", "P", ",", "target", ",", "Z"}], "]"}]}], 
             "}"}], "]"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pmin", "=", 
       RowBox[{"P", "/.", 
        RowBox[{"min", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Pmin", ",", 
        RowBox[{"min", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"min", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "pts"}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852404190420083*^9, 3.852404192889161*^9}, 
   3.8525191294836597`*^9, {3.8525229720995436`*^9, 3.85252297251528*^9}, {
   3.8525231810872483`*^9, 3.8525232817505465`*^9}, {3.8525233693977566`*^9, 
   3.8525234154258356`*^9}, 3.8525236130977736`*^9, {3.8525236740775414`*^9, 
   3.852523695445238*^9}, {3.8525288952691565`*^9, 3.8525289146638565`*^9}, {
   3.8525289600975466`*^9, 3.8525290044935713`*^9}, {3.8525291232839518`*^9, 
   3.852529277209662*^9}, {3.852529373571191*^9, 3.8525294001834135`*^9}, {
   3.852529433805731*^9, 3.8525294710568447`*^9}, {3.852529504781372*^9, 
   3.8525295650172048`*^9}, {3.852529809466228*^9, 3.852529809813213*^9}, {
   3.8525298518828154`*^9, 3.8525298588429885`*^9}, {3.8525299009256835`*^9, 
   3.852529925301303*^9}, {3.85253374205307*^9, 3.852533762028884*^9}, {
   3.8525338453386*^9, 3.8525338640684175`*^9}, {3.852534116180174*^9, 
   3.852534133303691*^9}, {3.8525342521375294`*^9, 3.8525342815305204`*^9}, {
   3.8525346504396877`*^9, 3.85253465517865*^9}, 3.852534782584762*^9, 
   3.8525348879059944`*^9, {3.852593094681492*^9, 3.852593101851184*^9}, 
   3.852593326279497*^9, {3.8526009377822895`*^9, 3.8526009687532296`*^9}, {
   3.8526010026739902`*^9, 3.8526010921478615`*^9}, {3.852601175532125*^9, 
   3.852601191312668*^9}, {3.8526012659108295`*^9, 3.852601274454294*^9}, {
   3.852601313702859*^9, 3.852601328678684*^9}, {3.8526013693336043`*^9, 
   3.852601375469681*^9}, {3.852601429749921*^9, 3.8526014312620125`*^9}, {
   3.8526014666830606`*^9, 3.8526014786699486`*^9}, {3.8526015683274937`*^9, 
   3.852601582377941*^9}, {3.8526016720920477`*^9, 3.8526017485800076`*^9}, {
   3.8526017890330524`*^9, 3.8526018309221916`*^9}, {3.8526041891694875`*^9, 
   3.8526044287284217`*^9}, {3.8526053928783484`*^9, 3.852605410025012*^9}, {
   3.852609036150224*^9, 3.852609045393509*^9}, {3.8526655652166033`*^9, 
   3.8526655674111953`*^9}, {3.853439342628142*^9, 3.853439364913411*^9}, {
   3.853444133250492*^9, 3.853444178203556*^9}, {3.853446677944444*^9, 
   3.8534466972738595`*^9}, {3.8534467560522904`*^9, 3.853446756233281*^9}, {
   3.8547302468060493`*^9, 3.854730256992304*^9}, {3.854730510364978*^9, 
   3.8547305187250996`*^9}, {3.8547314497803307`*^9, 
   3.8547314503378544`*^9}, {3.861594200175208*^9, 3.861594206852409*^9}, {
   3.8616039416873693`*^9, 3.861603941990614*^9}, {3.8616041772977734`*^9, 
   3.8616042216953764`*^9}, {3.8616509174063225`*^9, 
   3.8616509655704947`*^9}, {3.8616546058471107`*^9, 
   3.8616546267098494`*^9}, {3.8616708530541644`*^9, 
   3.8616708663538313`*^9}, {3.861671119448254*^9, 3.861671173340042*^9}, {
   3.8616756940147552`*^9, 3.8616757007106113`*^9}, 3.861677037144215*^9, {
   3.8623504423320694`*^9, 3.862350450974165*^9}, {3.8623524131075478`*^9, 
   3.862352413258685*^9}, {3.863223849669815*^9, 3.863223862310834*^9}, {
   3.8632240836184697`*^9, 3.8632241478535585`*^9}, {3.863224204900215*^9, 
   3.863224231476712*^9}, {3.8632242765157814`*^9, 3.863224281002284*^9}, {
   3.8632243594293766`*^9, 3.8632244042853622`*^9}, {3.863224751337788*^9, 
   3.863224763663918*^9}, {3.863224949739196*^9, 3.863225019809495*^9}, {
   3.863225058272909*^9, 3.8632250591951504`*^9}, {3.863225244095145*^9, 
   3.863225301918752*^9}, {3.8632260227441745`*^9, 3.863226057273082*^9}, {
   3.86322612095389*^9, 3.8632261384471197`*^9}, {3.863226176546504*^9, 
   3.8632261794364705`*^9}, {3.863226252637777*^9, 3.863226275745927*^9}, {
   3.8632264737227736`*^9, 3.863226474433278*^9}, {3.86322661385806*^9, 
   3.863226639571908*^9}, {3.863226742930098*^9, 3.8632267746601973`*^9}, {
   3.863226869420534*^9, 3.863226881762192*^9}, {3.8632270848368464`*^9, 
   3.863227086490505*^9}, {3.8632271642328835`*^9, 3.8632272037215967`*^9}, {
   3.863227353815919*^9, 3.8632273649574156`*^9}, {3.8632275045760555`*^9, 
   3.8632275065997458`*^9}, {3.863228291587123*^9, 3.863228293298164*^9}, {
   3.863228343048689*^9, 3.863228347480178*^9}, {3.86322846337788*^9, 
   3.8632284635819817`*^9}, {3.863229087437335*^9, 3.86322909383443*^9}, {
   3.863231877788905*^9, 3.863231881295216*^9}, {3.8632319191619987`*^9, 
   3.863231943346018*^9}, {3.863233369399495*^9, 3.863233385564896*^9}, {
   3.8635555266942606`*^9, 3.863555602736023*^9}, 3.863555673902278*^9, {
   3.863569808796626*^9, 3.86356986305692*^9}, {3.863569989994666*^9, 
   3.863570104769327*^9}, {3.86357027933712*^9, 3.863570318837636*^9}, {
   3.863570504984437*^9, 3.8635705183232465`*^9}, {3.863570733007725*^9, 
   3.8635707884895267`*^9}, {3.8636362627396426`*^9, 3.863636271107273*^9}, {
   3.863636383112319*^9, 3.8636363835456066`*^9}, {3.876483245069289*^9, 
   3.87648325306991*^9}, {3.876483302214222*^9, 3.8764833029027376`*^9}, {
   3.876483454724821*^9, 3.8764834562922535`*^9}, {3.8819602992408085`*^9, 
   3.8819603434870315`*^9}},ExpressionUUID->"9db2f589-0817-4c82-956d-\
e8e770ecb29d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization constraint functions", "Subsubsection",
 CellChangeTimes->{{3.852523011064973*^9, 3.8525230140537567`*^9}, 
   3.8819603755895233`*^9},ExpressionUUID->"d157d917-6b29-4a50-a0bc-\
a2ebc913ec08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"constrNegativeActiv", "[", "\[Gamma]List_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Gamma]List", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "<=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]List", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrEpsNegativeActiv", "[", 
    RowBox[{"\[Gamma]List_", ",", "\[Epsilon]_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Gamma]List", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "<=", 
      RowBox[{"-", "\[Epsilon]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]List", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrActivMag", "[", 
    RowBox[{"\[Gamma]List_", ",", "\[Gamma]MagMax_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Gamma]List", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "\[Gamma]MagMax"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]List", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrCenterlineZ", "[", 
    RowBox[{"rPar_", ",", "P_", ",", "Zlist_", ",", "ZMax_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"centerlineVal", "[", 
        RowBox[{"rPar", ",", "P", ",", 
         RowBox[{"Zlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "<", "ZMax"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrCenterlineZPlane", "[", 
    RowBox[{"rPar_", ",", "P_", ",", "Zlist_", ",", "n_", ",", "x_"}], "]"}], 
   ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"centerlineVal", "[", 
        RowBox[{"rPar", ",", "P", ",", 
         RowBox[{"Zlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "<", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"n", "[", 
         RowBox[{"[", "3", "]"}], "]"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", " ", 
          RowBox[{"n", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", " ", 
          RowBox[{"n", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", " ", 
          RowBox[{"n", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "*", 
          RowBox[{
           RowBox[{"centerlineVal", "[", 
            RowBox[{"rPar", ",", "P", ",", 
             RowBox[{"Zlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"centerlineVal", "[", 
            RowBox[{"rPar", ",", "P", ",", 
             RowBox[{"Zlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrCenterlineOutsideCylinder", "[", 
    RowBox[{"rPar_", ",", "P_", ",", "Zlist_", ",", "cylinder_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"centerlineVal", "[", 
       RowBox[{"rPar", ",", "P", ",", 
        RowBox[{"Zlist", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "\[Element]", 
      RowBox[{"RegionDifference", "[", 
       RowBox[{
        RowBox[{"FullRegion", "[", "3", "]"}], ",", "cylinder"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrCenterlineOutsideCylinderIneq", "[", 
    RowBox[{
    "rPar_", ",", "P_", ",", "Zlist_", ",", "center_", ",", "r_", ",", 
     "rodBuffer_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"centerlineVal", "[", 
            RowBox[{"rPar", ",", "P", ",", 
             RowBox[{"Zlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"center", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"centerlineVal", "[", 
            RowBox[{"rPar", ",", "P", ",", 
             RowBox[{"Zlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"center", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}]}], ">", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "+", "rodBuffer"}], ")"}], "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrCenterlineOutsideCylinderAlongLine", "[", 
    RowBox[{
    "rPar_", ",", "P_", ",", "Zlist_", ",", "cylinderOrigin_", ",", 
     "cylinderVec_", ",", "cylinderR_", ",", "rodBuffer_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "rcurrent", "}"}], ",", 
       RowBox[{
        RowBox[{"rcurrent", "=", 
         RowBox[{"centerlineVal", "[", 
          RowBox[{"rPar", ",", "P", ",", 
           RowBox[{"Zlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"rcurrent", "-", "cylinderOrigin", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rcurrent", "-", "cylinderOrigin"}], ")"}], ".", 
              "cylinderVec"}], ")"}], " ", "cylinderVec"}]}], "]"}], ">", 
         RowBox[{"cylinderR", "+", "rodBuffer"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrUMag", "[", 
    RowBox[{"UMax_", ",", "ZList_", ",", "u1_", ",", "u2_", ",", "u3_"}], 
    "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"u1", "^", "2"}], "+", 
           RowBox[{"u2", "^", "2"}], "+", 
           RowBox[{"u3", "^", "2"}]}], "]"}], ",", 
         RowBox[{"Z", "->", 
          RowBox[{"ZList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], "<=", "UMax"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ZList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constrUMagIndividual", "[", 
    RowBox[{"uMax_", ",", "ZList_", ",", "u1_", ",", "u2_", ",", "u3_"}], 
    "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"u1", ",", 
           RowBox[{"Z", "->", 
            RowBox[{"ZList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "<", "uMax"}], ",", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"u2", ",", 
           RowBox[{"Z", "->", 
            RowBox[{"ZList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "<", "uMax"}], ",", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"u3", ",", 
           RowBox[{"Z", "->", 
            RowBox[{"ZList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "<=", "uMax"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ZList", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8526660884698877`*^9, 3.852666107311297*^9}, {
   3.8526661618844013`*^9, 3.852666223100403*^9}, {3.8526663150343933`*^9, 
   3.8526663161621227`*^9}, {3.8526663657465086`*^9, 
   3.8526664086696653`*^9}, {3.85284371907625*^9, 3.852843722682474*^9}, {
   3.85284375699545*^9, 3.8528437820053844`*^9}, {3.852844177026908*^9, 
   3.852844219147977*^9}, {3.85284426623178*^9, 3.852844343970434*^9}, {
   3.852844707367468*^9, 3.85284471294032*^9}, {3.852845586889324*^9, 
   3.8528456116823053`*^9}, {3.8528468538609905`*^9, 3.852846863459795*^9}, {
   3.852847198083232*^9, 3.852847332345059*^9}, {3.8528473922771225`*^9, 
   3.852847392471306*^9}, {3.8528617290918293`*^9, 3.8528617763770437`*^9}, {
   3.8528625104846396`*^9, 3.8528625229157124`*^9}, {3.8537074077661095`*^9, 
   3.8537074748256693`*^9}, {3.8550910688930902`*^9, 
   3.8550910722857037`*^9}, {3.85509122130805*^9, 3.8550912215136356`*^9}, {
   3.8564889558613634`*^9, 3.856489084388339*^9}, {3.8564891150825024`*^9, 
   3.856489148397627*^9}, {3.8564891937809873`*^9, 3.8564892896382446`*^9}, {
   3.859493076281211*^9, 3.8594930803453608`*^9}, {3.8600316125636935`*^9, 
   3.8600316133168592`*^9}, {3.86322373152252*^9, 3.8632237817089186`*^9}, 
   3.863228556623084*^9, {3.8632286072814755`*^9, 3.8632286142338457`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"cb1a53fa-6fdf-49ec-8237-9b2043bd8e6f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalized plotting functions", "Subsection",
 CellChangeTimes->{{3.8443733438868155`*^9, 3.844373358493599*^9}, {
  3.880544154951949*^9, 
  3.8805441565373163`*^9}},ExpressionUUID->"f2315786-ce08-42bb-90c7-\
e2bcdf8624d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tubePlotSimple", "[", 
     RowBox[{
     "rVal_", ",", "dVal_", ",", "Z1_", ",", "Z2_", ",", "R2_", ",", "color_",
       ",", "opacity_", ",", "specularity_", ",", "specExp_", ",", 
      "plotPoints_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{"rVal", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"\[CapitalTheta]", ",", 
            RowBox[{"dVal", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"dVal", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalTheta]", ",", "0", ",", 
         RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"color", ",", 
          RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tubePlotSimpleColorFunc", "[", 
     RowBox[{
     "rVal_", ",", "dVal_", ",", "Z1_", ",", "Z2_", ",", "R2_", ",", 
      "colorFunc_", ",", "opacity_", ",", "specularity_", ",", "specExp_", 
      ",", "plotPoints_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{"rVal", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"\[CapitalTheta]", ",", 
            RowBox[{"dVal", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"dVal", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalTheta]", ",", "0", ",", 
         RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
       RowBox[{"ColorFunction", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z", ",", "u", ",", "v"}], "}"}], ",", 
          RowBox[{"Hue", "[", 
           RowBox[{"colorFunc", "/.", 
            RowBox[{"Z", "->", "u"}]}], "]"}]}], "]"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
       RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tubePlotSimpleCustomColorFunc", "[", 
     RowBox[{
     "rVal_", ",", "dVal_", ",", "Z1_", ",", "Z2_", ",", "R2_", ",", 
      "colorScheme_", ",", "colorFunc_", ",", "opacity_", ",", "specularity_",
       ",", "specExp_", ",", "plotPoints_", ",", "logColorBounds_"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{"rVal", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"\[CapitalTheta]", ",", 
            RowBox[{"dVal", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"dVal", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalTheta]", ",", "0", ",", 
         RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
       RowBox[{"ColorFunction", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z", ",", "u", ",", "v"}], "}"}], ",", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"{", 
             RowBox[{"colorScheme", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Log", "@", 
                 RowBox[{"logColorBounds", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"Log", "@", 
                 RowBox[{"logColorBounds", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}], "]"}], 
           "[", 
           RowBox[{"Log", "[", 
            RowBox[{"colorFunc", "/.", 
             RowBox[{"Z", "->", "u"}]}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
       RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tubePlotSimpleCustomColorFuncLinear", "[", 
     RowBox[{
     "\[CapitalTheta]Fiber_", ",", "rVal_", ",", "dVal_", ",", "Z1_", ",", 
      "Z2_", ",", "R2_", ",", "colorScheme_", ",", "colorFunc_", ",", 
      "opacity_", ",", "specularity_", ",", "specExp_", ",", "plotPoints_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"ParametricPlot3D", "[", 
     RowBox[{
      RowBox[{"rVal", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"RotationMatrix", "[", 
          RowBox[{
           RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], ",", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
         RowBox[{"dVal", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[CapitalTheta]", ",", "0", ",", 
        RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
         RowBox[{"Specularity", "[", 
          RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
      RowBox[{"ColorFunction", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z", ",", "u", ",", "v"}], "}"}], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "colorScheme", "]"}], "[", 
          RowBox[{"colorFunc", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Z", "->", "u"}], ",", 
             RowBox[{"\[Theta]", "->", "v"}]}], "}"}]}], "]"}]}], "]"}]}], 
      ",", 
      RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
      RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cylinderPlot", "[", 
     RowBox[{
     "rVal_", ",", "dVal_", ",", "Z1_", ",", "Z2_", ",", "R1_", ",", "R2_", 
      ",", "color_", ",", "opacity_", ",", "specularity_", ",", "specExp_", 
      ",", "plotPoints_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", "0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", "0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", "0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", "0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specExp"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cylinderPlotTruncatedIn\[CapitalTheta]", "[", 
     RowBox[{
     "rVal_", ",", "dVal_", ",", "\[CapitalTheta]Bounds_", ",", "Z1_", ",", 
      "Z2_", ",", "R1_", ",", "R2_", ",", "color_", ",", "opacity_", ",", 
      "specularity_", ",", "plotPoints_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", "specularity", "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", "specularity", "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", "specularity", "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"\[CapitalTheta]", ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", "specularity", "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"First", "[", "\[CapitalTheta]Bounds", "]"}], ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", "R1", ",", "R2"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", "specularity", "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"Last", "[", "\[CapitalTheta]Bounds", "]"}], ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", "R1", ",", "R2"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", "specularity", "]"}]}], "]"}]}], ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "\"\<AlongFiber\>\"", " ", "routine", " ", "accounts", " ", 
     "for", " ", "the", " ", "helically", " ", "twisting", " ", "fibers", " ",
      "in", " ", "plotting", " ", "the", " ", "rod", " ", "domains"}], ",", 
    " ", 
    RowBox[{
    "but", " ", "it", " ", "requires", " ", "more", " ", "PlotPoints", " ", 
     "for", " ", "the", " ", "same", " ", "quality", " ", "of", " ", 
     "visualization", " ", "as", " ", 
     "cylinderPlotTruncatedIn\[CapitalTheta]", " ", "since", " ", "all", " ", 
     "parametric", " ", "surfaces", " ", "now", " ", "rotate", " ", 
     RowBox[{"(", 
      RowBox[{"possibly", " ", "rapidly"}], ")"}], " ", 
     RowBox[{
     "w", ".", "r", ".", "t", ".", " ", "\[CapitalTheta]", ".", " ", 
      "Hence"}]}], ",", " ", 
    RowBox[{"this", " ", "routine", " ", "will", " ", "be", " ", 
     RowBox[{"slower", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cylinderPlotTruncatedIn\[CapitalTheta]AlongFiber", "[", 
     RowBox[{
     "\[CapitalTheta]Fiber_", ",", "rVal_", ",", "dVal_", ",", 
      "\[CapitalTheta]Bounds_", ",", "Z1_", ",", "Z2_", ",", "R1_", ",", 
      "R2_", ",", "color_", ",", "opacity_", ",", "specularity_", ",", 
      "specularityExp_", ",", "plotPoints_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], "/.", 
              RowBox[{"Z", "\[Rule]", "Z2"}]}], ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], "/.", 
              RowBox[{"Z", "\[Rule]", "Z1"}]}], ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "cylinderPlotTruncatedIn\[CapitalTheta]AlongFiberWithSideStrips", "[", 
     RowBox[{
     "\[CapitalTheta]Fiber_", ",", "rVal_", ",", "dVal_", ",", 
      "\[CapitalTheta]Bounds_", ",", "Z1_", ",", "Z2_", ",", "R1_", ",", 
      "R2_", ",", "color_", ",", "opacity_", ",", "specularity_", ",", 
      "specularityExp_", ",", "plotPoints_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], "/.", 
              RowBox[{"Z", "\[Rule]", "Z2"}]}], ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z2"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"rVal", ",", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalTheta]", "+", "\[CapitalTheta]Fiber"}], "/.", 
              RowBox[{"Z", "\[Rule]", "Z1"}]}], ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"dVal", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "]"}], ".", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"dVal", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Z", "\[Rule]", "Z1"}]}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", 
          RowBox[{"R1", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}], ",", 
          RowBox[{"R2", "/.", 
           RowBox[{"Z", "\[Rule]", "Z1"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[CapitalTheta]Bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalTheta]Bounds", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "\[CapitalTheta]Fiber"}], 
             ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", "R1", ",", "R2"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"rVal", "+", 
         RowBox[{
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalTheta]Bounds", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "\[CapitalTheta]Fiber"}], 
             ",", 
             RowBox[{"dVal", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dVal", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "*", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "Z1", ",", "Z2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", "R1", ",", "R2"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"color", ",", 
           RowBox[{"Opacity", "[", "opacity", "]"}], ",", 
           RowBox[{"Specularity", "[", 
            RowBox[{"specularity", ",", "specularityExp"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
        RowBox[{"Lighting", "\[Rule]", "lighting"}]}], "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rodPlotFullListNonTapered", "[", 
     RowBox[{
     "rPar_", ",", "dPar_", ",", "\[Gamma]_", ",", "Z1_", ",", "Z2_", ",", 
      "\[Phi]2_", ",", "\[Alpha]2til_", ",", "R1_", ",", "R2_", ",", 
      "\[Theta]0_", ",", "\[Sigma]_", ",", "N\[Gamma]_", ",", "filled_", ",", 
      "ringColor_", ",", "fiberSectionColor_", ",", "ringOpacity_", ",", 
      "fiberSectionOpacity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nRings", ",", "rVal", ",", "dVal", ",", "R2Func", ",", 
        "\[CapitalTheta]OfZ"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nRings", "=", 
        RowBox[{"Length", "[", "R1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rVal", "=", 
        RowBox[{"centerlineVal", "[", 
         RowBox[{"rPar", ",", "\[Gamma]", ",", "Z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dVal", "=", 
        RowBox[{"directorVal", "[", 
         RowBox[{"dPar", ",", "\[Gamma]", ",", "Z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                "cylinderPlotTruncatedIn\[CapitalTheta]\
AlongFiberWithSideStrips", "[", 
                 RowBox[{
                  RowBox[{"Z", "*", 
                   RowBox[{
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Alpha]2til", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "]"}], "/", 
                    RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}]}], ",", "rVal", ",", 
                  "dVal", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", "Z1", ",", "Z2", ",", 
                  RowBox[{
                   RowBox[{"R1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"fiberSectionAdjustR1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"fiberSectionAdjustR2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{"fiberSectionColor", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", 
                  RowBox[{"fiberSectionOpacity", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", "specularity", ",",
                   "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                "cylinderPlotTruncatedIn\[CapitalTheta]AlongFiber", "[", 
                 RowBox[{
                  RowBox[{"Z", "*", 
                   RowBox[{
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Alpha]2til", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "]"}], "/", 
                    RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}]}], ",", "rVal", ",", 
                  "dVal", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}]}]}], "}"}], 
                  ",", "\[IndentingNewLine]", "Z1", ",", "Z2", ",", 
                  RowBox[{
                   RowBox[{"R1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"ringAdjustR1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"ringAdjustR2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{"ringColor", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", 
                  RowBox[{"ringOpacity", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", "specularity", ",",
                   "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ring", ",", "1", ",", "nRings"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"filled", ",", 
            RowBox[{"cylinderPlot", "[", 
             RowBox[{"rVal", ",", "dVal", ",", "Z1", ",", "Z2", ",", "0", ",", 
              RowBox[{
               RowBox[{"R1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", "tubeAdjustR"}], ",", 
              "tubeFillColor", ",", "tubeOpacity", ",", "specularity", ",", 
              "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rodPlotFullListNonTaperedSerial", "[", 
     RowBox[{
     "rPar_", ",", "dPar_", ",", "\[Gamma]_", ",", "Z1_", ",", "Z2_", ",", 
      "\[Phi]2_", ",", "\[Alpha]2til_", ",", "R1_", ",", "R2_", ",", 
      "\[Theta]0_", ",", "\[Sigma]_", ",", "N\[Gamma]_", ",", "filled_", ",", 
      "ringColor_", ",", "fiberSectionColor_", ",", "ringOpacity_", ",", 
      "fiberSectionOpacity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nRings", ",", "rVal", ",", "dVal", ",", "R2Func", ",", 
        "\[CapitalTheta]OfZ"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nRings", "=", 
        RowBox[{"Length", "[", "R1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rVal", "=", 
        RowBox[{"centerlineVal", "[", 
         RowBox[{"rPar", ",", "\[Gamma]", ",", "Z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dVal", "=", 
        RowBox[{"directorVal", "[", 
         RowBox[{"dPar", ",", "\[Gamma]", ",", "Z"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                "cylinderPlotTruncatedIn\[CapitalTheta]\
AlongFiberWithSideStrips", "[", 
                 RowBox[{
                  RowBox[{"Z", "*", 
                   RowBox[{
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Alpha]2til", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "]"}], "/", 
                    RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}]}], ",", "rVal", ",", 
                  "dVal", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", "Z1", ",", "Z2", ",", 
                  RowBox[{
                   RowBox[{"R1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"fiberSectionAdjustR1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"fiberSectionAdjustR2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{"fiberSectionColor", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", 
                  RowBox[{"fiberSectionOpacity", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", "specularity", ",",
                   "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                "cylinderPlotTruncatedIn\[CapitalTheta]AlongFiber", "[", 
                 RowBox[{
                  RowBox[{"Z", "*", 
                   RowBox[{
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Alpha]2til", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "]"}], "/", 
                    RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}]}], ",", "rVal", ",", 
                  "dVal", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}]}]}], "}"}], 
                  ",", "\[IndentingNewLine]", "Z1", ",", "Z2", ",", 
                  RowBox[{
                   RowBox[{"R1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"ringAdjustR1", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"R2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "*", 
                   RowBox[{"ringAdjustR2", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                  RowBox[{"ringColor", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", 
                  RowBox[{"ringOpacity", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], ",", "specularity", ",",
                   "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ring", ",", "1", ",", "nRings"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"filled", ",", 
            RowBox[{"cylinderPlot", "[", 
             RowBox[{"rVal", ",", "dVal", ",", "Z1", ",", "Z2", ",", "0", ",", 
              RowBox[{
               RowBox[{"R1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", "tubeAdjustR"}], ",", 
              "tubeFillColor", ",", "tubeOpacity", ",", "specularity", ",", 
              "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rodPlotFullList\[CapitalTheta]2", "[", 
    RowBox[{
    "rPar_", ",", "dPar_", ",", "\[Gamma]_", ",", "Z1_", ",", "Z2_", ",", 
     "\[Phi]2_", ",", "\[Alpha]2til_", ",", "R1_", ",", "R2_", ",", 
     "\[Theta]0_", ",", "\[Sigma]_", ",", "N\[Gamma]_", ",", "filled_", ",", 
     "ringColor_", ",", "fiberSectionColor_", ",", "ringOpacity_", ",", 
     "fiberSectionOpacity_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nRings", ",", "rVal", ",", "dVal", ",", "R2Func", ",", 
       "\[CapitalTheta]OfZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nRings", "=", 
       RowBox[{"Length", "[", "R1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rVal", "=", 
       RowBox[{"centerlineVal", "[", 
        RowBox[{"rPar", ",", "\[Gamma]", ",", "Z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dVal", "=", 
       RowBox[{"directorVal", "[", 
        RowBox[{"dPar", ",", "\[Gamma]", ",", "Z"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
               "cylinderPlotTruncatedIn\[CapitalTheta]\
AlongFiberWithSideStrips", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalTheta]2", "[", "ring", "]"}], "[", "Z", 
                  "]"}], ",", "rVal", ",", "dVal", ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}], ",", 
                   RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", "Z1", ",", "Z2", ",", 
                 RowBox[{
                  RowBox[{"R1", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], "*", 
                  RowBox[{"fiberSectionAdjustR1", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"R2", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], "*", 
                  RowBox[{"fiberSectionAdjustR2", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                 RowBox[{"fiberSectionColor", "[", 
                  RowBox[{"[", "ring", "]"}], "]"}], ",", 
                 RowBox[{"fiberSectionOpacity", "[", 
                  RowBox[{"[", "ring", "]"}], "]"}], ",", "specularity", ",", 
                 "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"N\[Gamma]", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
              "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
               "cylinderPlotTruncatedIn\[CapitalTheta]AlongFiber", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalTheta]2", "[", "ring", "]"}], "[", "Z", 
                  "]"}], ",", "rVal", ",", "dVal", ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", "i"}]}], ",", 
                   RowBox[{
                    RowBox[{"\[Theta]0", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"Pi", "/", 
                    RowBox[{"N\[Gamma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", "ring", "]"}], "]"}], "/", "2"}]}]}], "}"}], 
                 ",", "\[IndentingNewLine]", "Z1", ",", "Z2", ",", 
                 RowBox[{
                  RowBox[{"R1", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], "*", 
                  RowBox[{"ringAdjustR1", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"R2", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], "*", 
                  RowBox[{"ringAdjustR2", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}]}], ",", 
                 RowBox[{"ringColor", "[", 
                  RowBox[{"[", "ring", "]"}], "]"}], ",", 
                 RowBox[{"ringOpacity", "[", 
                  RowBox[{"[", "ring", "]"}], "]"}], ",", "specularity", ",", 
                 "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"N\[Gamma]", "[", 
                   RowBox[{"[", "ring", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
              "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ring", ",", "1", ",", "nRings"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"filled", ",", 
           RowBox[{"cylinderPlot", "[", 
            RowBox[{"rVal", ",", "dVal", ",", "Z1", ",", "Z2", ",", "0", ",", 
             RowBox[{
              RowBox[{"R1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "tubeAdjustR"}], ",", 
             "tubeFillColor", ",", "tubeOpacity", ",", "specularity", ",", 
             "specularityExponent", ",", "plotPoints"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.844373382832967*^9, 3.84437338630243*^9}, {
   3.8453487300874214`*^9, 3.845348867240905*^9}, {3.8454435898105116`*^9, 
   3.8454435902289352`*^9}, {3.8460404014271126`*^9, 3.846040422922124*^9}, {
   3.8480178190350695`*^9, 3.848017825512749*^9}, {3.84803486728264*^9, 
   3.848034907302771*^9}, {3.8480353435608435`*^9, 3.8480354127658696`*^9}, {
   3.8480356778205667`*^9, 3.848035726150084*^9}, {3.848036380142582*^9, 
   3.848036384011606*^9}, {3.8526701797835636`*^9, 3.852670215129255*^9}, {
   3.8526717177837973`*^9, 3.8526717987995415`*^9}, {3.852671867460595*^9, 
   3.8526719214352183`*^9}, {3.8526721271659346`*^9, 3.852672135190071*^9}, {
   3.8527047207809334`*^9, 3.8527047212603703`*^9}, {3.8528591954412713`*^9, 
   3.852859222366866*^9}, {3.8528592659932833`*^9, 3.8528592836421494`*^9}, {
   3.8528626394352517`*^9, 3.8528626766465597`*^9}, {3.8551140513365736`*^9, 
   3.8551141157807045`*^9}, {3.8594022310917916`*^9, 3.859402298030131*^9}, {
   3.859402693879761*^9, 3.8594027107187757`*^9}, {3.8594031306361213`*^9, 
   3.859403159229351*^9}, {3.859428699439625*^9, 3.8594287048051558`*^9}, {
   3.859520435894729*^9, 3.859520486529715*^9}, {3.8635497572233973`*^9, 
   3.863549816520528*^9}, 3.86354997708879*^9, {3.863550659790428*^9, 
   3.863550764501387*^9}, {3.8638366905888414`*^9, 3.8638367058359375`*^9}, {
   3.8638369568640013`*^9, 3.8638369676562805`*^9}, {3.863837001030794*^9, 
   3.8638370333098717`*^9}, {3.8638370725352783`*^9, 
   3.8638371081971593`*^9}, {3.8638384511830854`*^9, 
   3.8638384585660954`*^9}, {3.8638427976551323`*^9, 
   3.8638428134929132`*^9}, {3.863844516974533*^9, 3.863844546579077*^9}, {
   3.864400860227895*^9, 3.864400873654129*^9}, {3.864405379384097*^9, 
   3.864405431137214*^9}, {3.864405495306839*^9, 3.864405503066365*^9}, {
   3.8644055394041204`*^9, 3.8644055568484087`*^9}, {3.8644056206907187`*^9, 
   3.8644056466595736`*^9}, {3.8644058535281315`*^9, 3.86440585380736*^9}, 
   3.8644059930032387`*^9, {3.876363108648813*^9, 3.876363123563952*^9}, {
   3.876364499143428*^9, 3.876364502745352*^9}, {3.876364587484295*^9, 
   3.8763645916585865`*^9}, 3.8763646338985257`*^9, {3.880543986813094*^9, 
   3.880543994185663*^9}, {3.88054409578276*^9, 3.880544131435197*^9}, {
   3.8819605764881773`*^9, 3.8819605775656385`*^9}, {3.881960740333652*^9, 
   3.8819607707835565`*^9}},ExpressionUUID->"8980923d-98eb-4eb0-a203-\
7ec58a6a3058"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Auxiliary global plot parameters", "Subsection",
 CellChangeTimes->{{3.852665002288471*^9, 3.8526650066105475`*^9}, {
  3.880543482751653*^9, 
  3.880543485197595*^9}},ExpressionUUID->"59035106-8609-405d-bd15-\
3ab2581636e4"],

Cell[BoxData[
 RowBox[{"colors", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\"\<DefaultPlotStyle\>\"", "/.", 
      RowBox[{"(", 
       RowBox[{"Method", "/.", " ", 
        RowBox[{"Charting`ResolvePlotTheme", "[", 
         RowBox[{"\"\<Standard\>\"", ",", "ListLinePlot"}], "]"}]}], ")"}]}], 
     ")"}], "/.", " ", 
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{"x_", ",", "__"}], "]"}], ":>", "x"}]}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8564019825261497`*^9, 3.8564019831489305`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"1ebcfaf1-9d15-42ad-b512-f1f30586e037"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"specularity", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"specularityExponent", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lighting", "=", "Automatic"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opaque", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotPoints", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmin", "=", 
   RowBox[{"-", "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmax", "=", "100"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"targetColor", "=", 
   RowBox[{"colors", "[", 
    RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ringColor", "=", 
   RowBox[{"{", 
    RowBox[{"Black", ",", "Blue"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tubeFillColor", "=", "White"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tubeOpacity", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tubeAdjustR", "=", "0.99"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fiberSectionColor", "=", 
   RowBox[{"{", 
    RowBox[{"Red", ",", 
     RowBox[{"Last", "[", "colors", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fiberSectionAdjustR1", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fiberSectionAdjustR2", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ringAdjustR1", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ringAdjustR2", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fiberSectionOpacity", "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "1.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ringOpacity", "=", 
    RowBox[{"{", 
     RowBox[{"1.0", ",", "0.5"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]0", "=", 
   RowBox[{"Most", "[", 
    RowBox[{"Subdivide", "[", 
     RowBox[{"0", ",", "1.0", ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8443110132659245`*^9, 3.844311065592087*^9}, {
   3.844316734811487*^9, 3.8443167757390594`*^9}, {3.844316836898888*^9, 
   3.844316976609256*^9}, 3.844317061928775*^9, {3.8443171925738907`*^9, 
   3.844317192867157*^9}, {3.8443178159522586`*^9, 3.8443178168951154`*^9}, {
   3.844320066120846*^9, 3.844320068493455*^9}, {3.8443209020698104`*^9, 
   3.8443209078884554`*^9}, 3.844321389744238*^9, {3.84432145401484*^9, 
   3.844321456371476*^9}, {3.844321927426319*^9, 3.8443219283636847`*^9}, {
   3.844322006722175*^9, 3.8443220071587205`*^9}, {3.8443222776657004`*^9, 
   3.844322304010816*^9}, {3.844322487043782*^9, 3.844322516960795*^9}, {
   3.8443229451888075`*^9, 3.844322983280072*^9}, {3.844323018867262*^9, 
   3.844323032105356*^9}, {3.8443230778208876`*^9, 3.8443230841918273`*^9}, 
   3.844323116892211*^9, {3.844323173433985*^9, 3.8443232574218254`*^9}, {
   3.8443233498600917`*^9, 3.844323350312503*^9}, {3.8443234576538863`*^9, 
   3.8443234611379895`*^9}, {3.8443237517052107`*^9, 
   3.8443237522426863`*^9}, {3.8443238918883257`*^9, 3.844323901735627*^9}, {
   3.844324021750863*^9, 3.844324022116332*^9}, {3.84432428729373*^9, 
   3.8443243244702125`*^9}, {3.8443244092738476`*^9, 
   3.8443244105146575`*^9}, {3.8443244563510237`*^9, 3.844324467235119*^9}, {
   3.844324774800391*^9, 3.8443248244676476`*^9}, 3.8443249565706196`*^9, {
   3.8443250069876456`*^9, 3.8443250090939975`*^9}, {3.844325067403978*^9, 
   3.8443250745074015`*^9}, {3.84432512182858*^9, 3.8443251222428474`*^9}, 
   3.8443252401754427`*^9, 3.844325375093974*^9, {3.8443737831081533`*^9, 
   3.8443738129627466`*^9}, {3.8443738517314878`*^9, 
   3.8443739178210177`*^9}, {3.844373951313985*^9, 3.8443739698619766`*^9}, 
   3.844374520622109*^9, {3.8443747376767125`*^9, 3.84437476688124*^9}, 
   3.844374868940772*^9, 3.8443752899137883`*^9, {3.844375340109167*^9, 
   3.8443753401452007`*^9}, 3.844375388631945*^9, 3.844375536267001*^9, 
   3.844375613714231*^9, 3.844375647600897*^9, {3.8443781786100206`*^9, 
   3.8443781787401385`*^9}, {3.8443795917095013`*^9, 3.8443796244971247`*^9}, 
   3.844379663384864*^9, {3.8443889431283236`*^9, 3.8443889882441616`*^9}, {
   3.844391064470396*^9, 3.8443910663527374`*^9}, {3.844398020914774*^9, 
   3.844398021428994*^9}, 3.84544199723839*^9, {3.8454420455198708`*^9, 
   3.845442049790606*^9}, 3.8454422847274404`*^9, {3.845511818645089*^9, 
   3.8455118222282305`*^9}, {3.8526651283116317`*^9, 3.852665202140254*^9}, 
   3.8526704869873085`*^9, {3.852703552975103*^9, 3.852703553156045*^9}, {
   3.8527039916552305`*^9, 3.852703992044837*^9}, 3.8527046038566356`*^9, 
   3.852704748434146*^9, {3.852835715070238*^9, 3.852835746850114*^9}, {
   3.8528358175220146`*^9, 3.8528358521355176`*^9}, {3.85283606293419*^9, 
   3.8528360948899717`*^9}, {3.8528361867074137`*^9, 3.852836190559474*^9}, 
   3.8528365563904085`*^9, 3.852836591647808*^9, {3.8528373704305983`*^9, 
   3.8528373705356293`*^9}, 3.8528377543550763`*^9, {3.8528378504517956`*^9, 
   3.852837896270618*^9}, 3.852838006074164*^9, {3.8528380958654613`*^9, 
   3.8528381038694096`*^9}, 3.8528634042274303`*^9, 3.8528638480456686`*^9, {
   3.8528807575899496`*^9, 3.852880757837736*^9}, {3.8528812540279503`*^9, 
   3.852881254179309*^9}, {3.8532089057794557`*^9, 3.853208927116145*^9}, {
   3.8537072775165143`*^9, 3.8537073015092688`*^9}, {3.874668655399124*^9, 
   3.874668660326141*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"4ec0129c-1e0a-4b0a-85f4-9c0a04ccf659"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 747.75},
WindowMargins->{{-4.7999999999999545`, Automatic}, {-6, Automatic}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4721fb35-4f8f-4e33-99ee-92d08aafc19b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 219, 4, 67, "Section",ExpressionUUID->"6c742f1b-1d09-41c9-b63b-f5db958d3384"],
Cell[CellGroupData[{
Cell[824, 30, 175, 3, 54, "Subsection",ExpressionUUID->"720b4dae-050c-4218-aa7e-219c6456de55"],
Cell[1002, 35, 7304, 176, 616, "Input",ExpressionUUID->"c08016c8-4247-4697-95c1-9c157bfc9410",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[8343, 216, 336, 5, 54, "Subsection",ExpressionUUID->"57c9140b-0491-41b0-a967-887b7dab3aff"],
Cell[CellGroupData[{
Cell[8704, 225, 4542, 65, 45, "Subsubsection",ExpressionUUID->"dbf447d5-8e5a-4b3b-b59f-9f130fbea081"],
Cell[13249, 292, 44982, 1048, 1066, "Input",ExpressionUUID->"d3e665d9-e463-4803-b6a1-50cad8c71a54",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[58268, 1345, 212, 3, 45, "Subsubsection",ExpressionUUID->"9ca6cd07-308c-4d7c-88e2-96e1a1508922"],
Cell[58483, 1350, 4432, 113, 311, "Input",ExpressionUUID->"d9e2df5d-efdb-4802-a1fb-1f4703cc9281",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[62952, 1468, 201, 3, 45, "Subsubsection",ExpressionUUID->"aac5519e-ed5a-4eab-b054-cfedecc3bf32"],
Cell[63156, 1473, 16486, 364, 749, "Input",ExpressionUUID->"c26a56aa-81a0-460d-85ed-f49eb3767a59",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[79679, 1842, 646, 18, 46, "Subsubsection",ExpressionUUID->"6c51bf03-0137-4d80-af21-9a7006d83ac9"],
Cell[80328, 1862, 17536, 384, 958, "Input",ExpressionUUID->"16350554-e7a8-4137-8ac1-445756d6bc54",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97913, 2252, 317, 5, 54, "Subsection",ExpressionUUID->"3d80c9da-94d4-4019-a81f-23049b37aad5"],
Cell[CellGroupData[{
Cell[98255, 2261, 219, 6, 45, "Subsubsection",ExpressionUUID->"b8e5d85b-531c-40ca-952c-6266533f2f0e"],
Cell[98477, 2269, 5645, 118, 121, "Input",ExpressionUUID->"6af3755f-5af8-4c3c-aa07-6b9306c9a7ca",
 InitializationCell->True],
Cell[104125, 2389, 24928, 565, 863, "Input",ExpressionUUID->"fca1f60b-726a-4726-95df-130cb74a33e6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[129090, 2959, 283, 6, 45, "Subsubsection",ExpressionUUID->"1b278c7e-82a8-41c2-842e-00ee18113a91"],
Cell[129376, 2967, 5265, 108, 83, "Input",ExpressionUUID->"bb1eafa5-150e-4a44-9010-fbd55223d612",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134690, 3081, 174, 3, 54, "Subsection",ExpressionUUID->"a92e096d-730e-478e-b9ac-4019bb2e5305"],
Cell[CellGroupData[{
Cell[134889, 3088, 190, 3, 45, "Subsubsection",ExpressionUUID->"bddf7fe9-25f1-48c6-bf8f-fc5b2e7f1c60"],
Cell[135082, 3093, 15820, 337, 901, "Input",ExpressionUUID->"9db2f589-0817-4c82-956d-e8e770ecb29d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[150939, 3435, 211, 3, 45, "Subsubsection",ExpressionUUID->"d157d917-6b29-4a50-a0bc-a2ebc913ec08"],
Cell[151153, 3440, 10429, 280, 361, "Input",ExpressionUUID->"cb1a53fa-6fdf-49ec-8237-9b2043bd8e6f",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161631, 3726, 231, 4, 54, "Subsection",ExpressionUUID->"f2315786-ce08-42bb-90c7-e2bcdf8624d9"],
Cell[161865, 3732, 64296, 1451, 2651, "Input",ExpressionUUID->"8980923d-98eb-4eb0-a203-7ec58a6a3058",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[226198, 5188, 231, 4, 54, "Subsection",ExpressionUUID->"59035106-8609-405d-bd15-3ab2581636e4"],
Cell[226432, 5194, 638, 16, 44, "Input",ExpressionUUID->"1ebcfaf1-9d15-42ad-b512-f1f30586e037",
 InitializationCell->True],
Cell[227073, 5212, 5854, 117, 444, "Input",ExpressionUUID->"4ec0129c-1e0a-4b0a-85f4-9c0a04ccf659",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

